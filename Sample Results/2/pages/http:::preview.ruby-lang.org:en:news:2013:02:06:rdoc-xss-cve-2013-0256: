<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
   "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <title>XSS exploit of RDoc documentation generated by rdoc (CVE-2013-0256)</title>
    <link rel="stylesheet" type="text/css" href="/stylesheets/low.css" />
    <link rel="stylesheet" type="text/css" href="/stylesheets/screen.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/stylesheets/print.css" media="print" />
    <link title="Low vision" rel="alternate stylesheet" type="text/css" href="/stylesheets/low_vision_screen.css" media="screen" />
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    
    
  </head>
  <body>
    <div id="page">
      <div id="header">
        <div id="logo"><a href="/en/"><img src="/images/logo.gif" width="331" height="119" alt="Ruby - A Programmer's Best Friend" title="" /></a></div>
        <div class="site-links">
<a href="/en/downloads/">Downloads</a><span class="separator"> | </span><a href="/en/documentation/">Documentation</a><span class="separator"> | </span><a href="/en/libraries/">Libraries</a><span class="separator"> | </span><a href="/en/community/">Community</a><span class="separator"> | </span><strong><a href="/en/news/">News</a></strong><span class="separator"> | </span><a href="/en/security/">Security</a><span class="separator"> | </span><a href="/en/about/">About Ruby</a>
        </div>
      </div>
      <hr class="hidden-modern" />
      <div id="main-wrapper">
        <div id="main">
          <div id="content-wrapper">
            <div id="head-wrapper-1">
              <div id="head-wrapper-2">
                <div id="head">

                  <h1>XSS exploit of RDoc documentation generated by rdoc (CVE-2013-0256)</h1>
                </div>
              </div>
            </div>
            <div id="content">
<p>RDoc documentation generated by rdoc bundled with ruby are vulnerable to an XSS
exploit.
All ruby users are recommended to update ruby to newer version which includes
security-fixed RDoc.
If you are publishing RDoc documentation generated by rdoc, you are recommended
to apply a patch for the documentaion or re-generate it with security-fixed
RDoc.</p><h2><a name="label-0" id="label-0">Impact</a></h2><!-- RDLabel: "Impact" --><p>RDoc documentation generated by rdoc 2.3.0 through rdoc 3.12 and prereleases up
to rdoc 4.0.0.preview2.1 are vulnerable to an XSS exploit.  This exploit may
lead to cookie disclosure to third parties.</p>
<div id="extended">
<h2><a name="label-0" id="label-0">Details</a></h2><!-- RDLabel: "Details" --><p>The exploit exists in darkfish.js which is copied from the RDoc install
location to the generated documentation.</p><p>RDoc is a static documentation generation tool.  Patching the library itself
is insufficient to correct this exploit.  Those hosting rdoc documentation will
need to apply the following patch.</p><h2><a name="label-1" id="label-1">Solution</a></h2><!-- RDLabel: "Solution" --><p>Please apply the following patch to rdoc documatation.
If applied while ignoring whitespace, this patch will correct all affected
versions:</p><pre>diff --git darkfish.js darkfish.js
index 4be722f..f26fd45 100644
--- darkfish.js
+++ darkfish.js
@@ -109,13 +109,15 @@ function hookSearch() {
 function highlightTarget( anchor ) {
   console.debug( "Highlighting target '%s'.", anchor );

-  $("a[name=" + anchor + "]").each( function() {
-    if ( !$(this).parent().parent().hasClass('target-section') ) {
-      console.debug( "Wrapping the target-section" );
-      $('div.method-detail').unwrap( 'div.target-section' );
-      $(this).parent().wrap( '&lt;div class="target-section"&gt;&lt;/div&gt;' );
-    } else {
-      console.debug( "Already wrapped." );
+  $("a[name]").each( function() {
+    if ( $(this).attr("name") == anchor ) {
+      if ( !$(this).parent().parent().hasClass('target-section') ) {
+        console.debug( "Wrapping the target-section" );
+        $('div.method-detail').unwrap( 'div.target-section' );
+        $(this).parent().wrap( '&lt;div class="target-section"&gt;&lt;/div&gt;' );
+      } else {
+        console.debug( "Already wrapped." );
+      }
     }
   });
 };</pre><p>And, if you are using ruby 1.9, please update <a href="http://www.ruby-lang.org/en/news/2013/02/06/ruby-1-9-3-p385-is-released/">ruby-1.9.3 patchlevel 385</a>.
If you are using ruby 2.0.0 rc1 or prior or ruby trunk, please update to ruby 2.0.0 rc2 or trunk revision 39102 or later.
You can also update RDoc itself with rubygems to RDoc 3.12.1 or RDoc 4.0.0.rc.2.</p><h2><a name="label-2" id="label-2">Affected versions</a></h2><!-- RDLabel: "Affected versions" --><ul>
<li>All ruby 1.9 versions prior to ruby 1.9.3 patchlevel 383</li>
<li>All ruby 2.0 versions prior to ruby 2.0.0 rc2 or prior to trunk revision 39102</li>
</ul><h2><a name="label-3" id="label-3">Credit</a></h2><!-- RDLabel: "Credit" --><p>This exploit was discovered by Evgeny Ermakov &lt;corwmh@gmail.com&gt;.</p><p>This vulnerability has been assigned the CVE identifier CVE-2013-0256.</p><h2><a name="label-4" id="label-4">History</a></h2><!-- RDLabel: "History" --><ul>
<li>Originally published at 2013-02-06 13:30:00 (UTC)</li>
</ul>
</div>
            </div>
          </div>
          <hr class="hidden-modern" />
          <div id="sidebar-wrapper">
            <div id="sidebar">




<div class="navigation">
  <h3><strong>Recent News</strong></h3>
  <ul class="menu">

    <li><a href="/en/news/2013/02/08/ruby-2-0-0-rc2-is-released/">Ruby 2.0.0-rc2 is released</a></li>

    <li><a href="/en/news/2013/02/06/ruby-1-9-3-p385-is-released/">Ruby 1.9.3-p385 is released</a></li>

    <li><a href="/en/news/2013/02/06/rdoc-xss-cve-2013-0256/">XSS exploit of RDoc documentation generated by rdoc (CVE-2013-0256)</a></li>

    <li><a href="/en/news/2013/01/23/confoo-with-ruby-in-montreal/">ConFoo with Ruby in Montreal</a></li>

    <li><a href="/en/news/2013/01/17/ruby-1-9-3-p374-is-released/">Ruby 1.9.3-p374 is released</a></li>

  </ul>
</div>



<h3>Syndicate</h3>
<p><a href="/en/feeds/news.rss">Recent News (RSS)</a></p>
            </div>
          </div>
          <hr class="hidden-modern" />
          <div class="foot">
            <div class="site-links">
<a href="/en/downloads/">Downloads</a><span class="separator"> | </span><a href="/en/documentation/">Documentation</a><span class="separator"> | </span><a href="/en/libraries/">Libraries</a><span class="separator"> | </span><a href="/en/community/">Community</a><span class="separator"> | </span><strong><a href="/en/news/">News</a></strong><span class="separator"> | </span><a href="/en/security/">Security</a><span class="separator"> | </span><a href="/en/about/">About Ruby</a>
            </div>
          </div>
        </div>
      </div>
      <div id="search-box">
<form id="search-form" action="http://www.google.com/cse">
  <table class="fieldset">
    <tr>
      <td>
        <input class="field" type="text" name="q" size="31" style="background: white url(http://www.google.com/coop/intl/en/images/google_custom_search_watermark.gif) left no-repeat" onfocus="this.style.background='white'" onblur="if (/^\s*$/.test(this.value)) this.style.background='white url(http://www.google.com/coop/intl/en/images/google_custom_search_watermark.gif) left no-repeat'"/>
      </td>
      <td>
        <input type="hidden" name="cx" value="013598269713424429640:g5orptiw95w" />
        <input type="hidden" name="ie" value="UTF-8" />
        <input class="button" type="submit" name="sa" value="Search" />
      </td>
    </tr>
  </table>
</form>
      </div>
      <div id="footer">
        <div class="fine-print">
          <p>Content available in <a href="/en/">English</a>, <a href="/fr/">French</a>, <a href="/ja/">Japanese</a>, <a href="/ko/">Korean</a>, <a href="/pl/">Polish</a>, <a href="/es/">Spanish</a>, <a href="/pt/">Portuguese</a>, <a href="/zh_cn/">Simplified Chinese</a>, <a href="/zh_TW/">Traditional Chinese</a>, <a href="/id/">Bahasa Indonesia</a>, <a href="/de/">German</a>, <a href="/it/">Italian</a>, <a href="/cs/">Czech</a>, <a href="/bg/">Bulgarian</a> and <a href="/tr/">Turkish</a>.</p> 
          <p>This website is made with Ruby and powered by <a href="http://radiantcms.org">Radiant CMS</a>.
            It is proudly maintained by <a href="http://rubyidentity.org">members of the Ruby community</a>. Please contact
            our <a href="mailto:webmaster@ruby-lang.org">webmaster</a> for questions or comments
            concerning this website.</p>
        </div>
      </div>
    </div>
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript" defer="defer">
// <![CDATA[
_uacct = "UA-620926-1";
urchinTracker();
// ]]>
</script>
  </body>
</html>