
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>
Issue 13814: Document why generators don't support the context management protocol - Python tracker

</title>
<link rel="shortcut icon" href="@@file/favicon.ico" />
<link rel="stylesheet" type="text/css" href="@@file/main.css" />
<link rel="stylesheet" type="text/css" href="@@file/style.css" />
<link rel="search" type="application/opensearchdescription+xml" href="@@file/osd.xml" title="Python bug tracker search" />
<meta http-equiv="Content-Type"
      content="text/html; charset=utf-8" />

<script type="text/javascript">
submitted = false;
function submit_once() {
    if (submitted) {
        alert("Your request is being processed.\nPlease be patient.");
        event.returnValue = 0;    // work-around for IE
        return 0;
    }
    submitted = true;
    return 1;
}

function help_window(helpurl, width, height) {
    HelpWin = window.open('http://bugs.python.org/' + helpurl, 'RoundupHelpWindow', 'scrollbars=yes,resizable=yes,toolbar=no,height='+height+',width='+width);
}
</script>


<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.15/jquery-ui.js"></script>
<script type="text/javascript" src="@@file/issue.item.js"></script>
<link rel="stylesheet" type="text/css" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/smoothness/jquery-ui.css" />


</head>
<body>
  <!--  Logo  -->
  <h1 id="logoheader">
    <a accesskey="1" href="." id="logolink">
       <img src="@@file/python-logo.gif" alt="homepage" border="0" id="logo" /></a>
  </h1>

<div id="utility-menu">
<!-- Search Box -->
<div id="searchbox">
    <form name="searchform" method="get" action="issue" id="searchform">
      <div id="search">
       <input type="hidden" name="@columns"
              value="id,activity,title,creator,assignee,status,type" />
       <input type="hidden" name="@sort" value="-activity" />
       <input type="hidden" name="@filter" value="status" />
       <input type="hidden" name="@action" value="searchid" />
       <input type="hidden" name="ignore" value="file:content" />
       <input class="input-text" id="search-text"
              name="@search_text" size="10" />
       <input type="submit" id="submit" value="search" name="submit" class="input-button" />
       <input type="radio" name="status"
              id="status_notresolved" value="-1,1,3" />
       <label for="status_notresolved">open</label>
       <input type="radio" name="status" checked="checked"
              id="status_all" value="-1,1,2,3" />
       <label for="status_all">all</label>
      </div>
     </form>
</div>
</div>


<div id="left-hand-navigation">
<!--  Main Menu NEED LEVEL TWO HEADER AND FOOTER -->
<div id="menu">
  <ul class="level-one">
    <li><a href="http://python.org/about" title="About The Python Language">About</a></li>
    <li><a href="http://python.org/news" title="">News</a></li>
    <li><a href="http://python.org/doc" title="">Documentation</a></li>
    <li><a href="http://python.org/download" title="">Download</a></li>
    <li><a href="http://python.org/community" title="">Community</a></li>
    <li><a href="http://python.org/psf" title="Python Software Foundation">Foundation</a></li>
    <li><a href="http://docs.python.org/devguide/" title="Python Core Language Development">Core Development</a></li>
    <li class="selected"><a href="." class="selected" title="Python Issue Tracker">Issue Tracker</a>
      <ul class="level-two">
        <li>
          <strong>Issues</strong>
          <ul class="level-three">
            
            <li><a href="issue?@template=search&amp;status=1">Search</a></li>
            <li><a href="issue?@action=random">Random Issue</a></li>
            <li>
              <form method="post" action="#">
                <input type="submit" class="form-small"
                       value="Show issue:" />
                <input class="form-small" size="4" type="text" name="@number" />
                <input type="hidden" name="@type" value="issue" />
                <input type="hidden" name="@action" value="show" />
              </form>
            </li>
          </ul>
        </li>


        <li>
          <strong>Summaries</strong>
          <ul class="level-three">
            

            

            

            <li>
              <a href="issue?status=1&amp;@sort=-activity&amp;@columns=id,activity,title,creator,status&amp;@dispname=Issues with patch&amp;@startwith=0&amp;@group=priority&amp;keywords=2&amp;@action=search&amp;@filter=&amp;@pagesize=50">Issues with patch</a>
            </li>

            <li>
              <a href="issue?status=1&amp;@sort=-activity&amp;@columns=id,activity,title,creator,status&amp;@dispname=Easy issues&amp;@startwith=0&amp;@group=priority&amp;keywords=6&amp;@action=search&amp;@filter=&amp;@pagesize=50">Easy issues</a>
            </li>

          </ul>
        </li>


        <li>
          <strong>User</strong>
          <form method="post" action="#">
          <ul class="level-three">
            <li>
                Login&nbsp;(OpenID&nbsp;possible)<br />
                <a style="display:inline;width:0;margin:0"
                   href="issue13814?@action=openid_login&amp;provider=Google">
                  <img hspace="0" vspace="0" width="16"
                       height="16"
                       src="http://www.google.com/favicon.ico"
                       alt="Google" title="Google" /></a>
                <a style="display:inline;width:0;margin:0"
                   href="issue13814?@action=openid_login&amp;provider=myOpenID">
                  <img hspace="0" vspace="0" width="16"
                       height="16"
                       src="https://www.myopenid.com/favicon.ico"
                       alt="myOpenID" title="myOpenID" /></a>
                <a style="display:inline;width:0;margin:0"
                   href="issue13814?@action=openid_login&amp;provider=Launchpad">
                  <img hspace="0" vspace="0" width="16"
                       height="16"
                       src="https://login.launchpad.net/favicon.ico"
                       alt="Launchpad" title="Launchpad" /></a>
                <input size="10" name="openid_identifier" style="background:url(http://wiki.openid.net/f/openid-16x16.gif)
                  center left no-repeat;padding-left:16px" /><br />
                <input size="10" type="password" name="__login_password" /><br />
                <input type="hidden" name="@action" value="Login" />
                <input type="checkbox" name="remember" id="remember" />
                <label for="remember">Remember me?</label><br />
                <input class="form-small" type="submit"
                       value="Login" /><br />
                <input type="hidden" name="__came_from"
                       value="issue13814" />
                <input type="hidden" name="@sort" value=""/>
<input type="hidden" name="@group" value=""/>
<input type="hidden" name="@pagesize" value="50"/>
<input type="hidden" name="@startwith" value="0"/>
            </li>
            <li>
                <a href="user?@template=register">Register</a>
            </li>
            <li><a href="user?@template=forgotten">Lost&nbsp;your&nbsp;login?</a></li>
          </ul>
          </form>
        </li>

        

        

        

        <li>
          <strong>Help</strong>
          <ul class="level-three">
            <li><a href="http://docs.python.org/devguide/triaging.html">
                Tracker Documentation</a></li>
            <li><a href="http://wiki.python.org/moin/TrackerDevelopment">
                Tracker Development</a></li>
            <li><a href="http://psf.upfronthosting.co.za/roundup/meta">
                Report Tracker Problem</a></li>
          </ul>
        </li>

      </ul>
    </li>
  </ul>
</div> <!-- menu -->
</div> <!-- left-hand-navigation -->

<div id="content-body">
<div id="body-main">
<div id="content">
<div id="breadcrumb">
 
 
 Issue13814
 
</div>
 
 





<div>

<form method="post" name="itemSynopsis"
      onsubmit="return submit_once()"
      enctype="multipart/form-data" action="issue13814">

<fieldset><legend>classification</legend>
<table class="form">
<tr>
 <th class="required"><a href="http://docs.python.org/devguide/triaging.html#title" target="_blank">Title</a>:</th>
 
 <td colspan="3">
  <span>Document why generators don't support the context management protocol</span>
  <input type="hidden" name="title"
         value="Document why generators don't support the context management protocol">
 </td>
</tr>

<tr>
 <th class="required"><a href="http://docs.python.org/devguide/triaging.html#type" target="_blank">Type</a>:</th>
 <td>enhancement</td>
 <th><a href="http://docs.python.org/devguide/triaging.html#stage" target="_blank">Stage</a>:</th>
 <td>needs patch</td>
</tr>

<tr>
 <th><a href="http://docs.python.org/devguide/triaging.html#components" target="_blank">Components</a>:</th>
 <td>Documentation</td>
 <th><a href="http://docs.python.org/devguide/triaging.html#versions" target="_blank">Versions</a>:</th>
 <td>Python 3.3</td>
</tr>
</table>
</fieldset>

<fieldset><legend>process</legend>
<table class="form">
<tr>
  <th><a href="http://docs.python.org/devguide/triaging.html#status" target="_blank">Status</a>:</th>
  <td>open</td>
  <th><a href="http://docs.python.org/devguide/triaging.html#resolution" target="_blank">Resolution</a>:</th>
  <td></td>
</tr>

<tr>
 <th>
    <a href="http://docs.python.org/devguide/triaging.html#dependencies"
       target="_blank">Dependencies</a>:
 </th>
 <td>
  
  
 </td>
 <th><a href="http://docs.python.org/devguide/triaging.html#superseder" target="_blank">Superseder</a>:</th>
 <td>
  
 
 </td>
 </tr>
 <tr>
 <th>
   <a href="http://docs.python.org/devguide/triaging.html#assigned-to"
      target="_blank">Assigned To</a>:
 </th>
 
 <td>
  docs@python
 </td>
 <th>
   <a href="http://docs.python.org/devguide/triaging.html#nosy-list"
      target="_blank">Nosy List</a><!--
        <span tal:condition="context/nosy_count" tal:replace="python: ' (%d)' % context.nosy_count" /> -->:
  
 </th>
 <td>
     docs@python, ezio.melotti, meador.inge, ncoghlan, terry.reedy, yak
     
 </td>
</tr>
<tr>
 <th>
   <a href="http://docs.python.org/devguide/triaging.html#priority"
      target="_blank">Priority</a>:
 </th>
 <td>normal</td>
 <th>
    <a href="http://docs.python.org/devguide/triaging.html#keywords"
       target="_blank">Keywords</a>:
 </th>
 <td></td>


</tr>







</table>
</fieldset>
<table class="form">

</table>
</form>

<p>Created on <strong>2012-01-18 10:43</strong> by <strong>yak</strong>, last changed <strong>2012-01-22 15:51</strong> by <strong>meador.inge</strong>.</p>





<table class="messages">
 <tr><th colspan="4" class="header">Messages (4)</th></tr>
 
  <tr>
    <th>
     <a href="#msg151530" id="msg151530">msg151530</a> - <a
    href="msg151530">(view)</a></th>
   <th>Author: Arkadiusz Wahlig (yak)</th>
   <th>Date: 2012-01-18 10:43</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>Generators should support the with statement with __exit__ calling self.close().

with genfunc() as g:
    for item in g:
        print(item)</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg151532" id="msg151532">msg151532</a> - <a
    href="msg151532">(view)</a></th>
   <th>Author: Ezio Melotti (ezio.melotti) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2012-01-18 10:57</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>If you want to call .close() automatically on something you can use contextlib.closing(): <a href="http://docs.python.org/library/contextlib.html#contextlib.closing">http://docs.python.org/library/contextlib.html#contextlib.closing</a></pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg151717" id="msg151717">msg151717</a> - <a
    href="msg151717">(view)</a></th>
   <th>Author: Terry J. Reedy (terry.reedy) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2012-01-21 04:03</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>Calling g.close() is pointless for a generator used in normal pull mode and run to completion, as in the example. The generator is already 'closed', so g.close() does not do anything useful. See
<a href="http://docs.python.org/py3k/reference/expressions.html#yield-expressions">http://docs.python.org/py3k/reference/expressions.html#yield-expressions</a>

The method was added to be used with .send() so that generators used in push mode could be told to finish up when there is nothing more to send. For such rare uses, contextlib.closing should usually be sufficient, I think.

So I think this issue should be closed.</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg151763" id="msg151763">msg151763</a> - <a
    href="msg151763">(view)</a></th>
   <th>Author: Nick Coghlan (ncoghlan) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2012-01-22 06:58</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>Generators deliberately don't support the context management protocol. This is so that they raise an explicit TypeError or AttributeError (pointing out that __exit__ is missing) if you leave out the @contextmanager decorator when you're using a generator to write an actual context manager.

Generators supporting the context management protocol natively would turn that into a far more subtle (and confusing) error: your code would silently fail to invoke the generator body.

Ensuring this common error remains easy to detect is far more important than making it easier to invoke close() on a generator object (particularly when contextlib.closing() already makes that very easy).</pre>
   </td>
  </tr>
 
</table>

<table class="history"><tr><th colspan="4" class="header">
History
</th></tr><tr>
<th>Date</th>
<th>User</th>
<th>Action</th>
<th>Args</th>
</tr>
<tr><td>2012-01-22&nbsp;15:51:35</td><td>meador.inge</td><td>set</td><td>nosy:
  + <a href="user11255">meador.inge</a><br /></td></tr>
<tr><td>2012-01-22&nbsp;06:58:16</td><td>ncoghlan</td><td>set</td><td>status: pending -> open<br /><br />assignee: <a href="user12260">docs@python</a><br />components:
  + Documentation<br />title: Generators as context managers. -> Document why generators don't support the context management protocol<br />nosy:
  + <a href="user12260">docs@python</a><br /><br />messages:
  + <a href="msg151763">msg151763</a><br />stage: test needed -> needs patch</td></tr>
<tr><td>2012-01-21&nbsp;04:03:30</td><td>terry.reedy</td><td>set</td><td>status: open -> pending<br /><br />nosy:
  + <a href="user155">terry.reedy</a><br />messages:
  + <a href="msg151717">msg151717</a><br /><br />stage: test needed</td></tr>
<tr><td>2012-01-20&nbsp;15:07:39</td><td>pitrou</td><td>set</td><td>nosy:
  + <a href="user1309">ncoghlan</a><br /><br />versions:
  + Python 3.3, - Python 2.7, Python 3.4</td></tr>
<tr><td>2012-01-18&nbsp;10:57:59</td><td>ezio.melotti</td><td>set</td><td>nosy:
  + <a href="user7047">ezio.melotti</a><br />messages:
  + <a href="msg151532">msg151532</a><br /></td></tr>
<tr><td>2012-01-18&nbsp;10:43:15</td><td>yak</td><td>create</td><td></td></tr>
</table>

</div>


</div> <!-- content-body -->
<div id="footer">
<div id="credits">
<a href="http://www.python.org/about/website">Website maintained by the Python community</a><br />

<a href="http://www.upfrontsystems.co.za/" title="issue tracker hosting provided by Upfront Systems, South Africa">hosting by Upfront Systems</a> /
  <a href="http://roundup.sf.net" title="Powered by the Roundup Issue Tracker">powered by Roundup</a>
</div> <!-- credits -->
Copyright &copy; 1990-2013, <a href="http://python.org/psf">Python Software Foundation</a><br />
<a href="http://python.org/about/legal">Legal Statements</a>
</div> <!-- footer -->
</div> <!-- body-main -->
</div> <!-- content -->



</body>
</html>

