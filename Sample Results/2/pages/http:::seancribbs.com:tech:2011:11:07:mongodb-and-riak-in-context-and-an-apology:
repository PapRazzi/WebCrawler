<!DOCTYPE html>
<html lang='en-US' xml:lang='en-US' xmlns='http://www.w3.org/1999/xhtml'>
  <head>
    <title>MongoDB and Riak, In Context (and an apology) -
    sean cribbs :: digital renaissance man</title>
    <link href='/stylesheets/baseline.css' rel='stylesheet' type='text/css' />
    <link href='/stylesheets/layout.css' rel='stylesheet' type='text/css' />
    <link href='/stylesheets/code.css' rel='stylesheet' type='text/css' />
    
  </head>
  <body>
    <div id='header'>
      <h1>Sean<span>Cribbs</span></h1>
      <h2>Digital Renaissance Man</h2>
    </div>
    <ul id="navigation">
<li><a href="/">home</a></li> 
<li><a href="/portfolio/">portfolio</a></li> 
<li><a href="/about/">about</a></li> 
<li><a href="/contact/">contact</a></li> 
</ul>

    <div id='content'>
      <div id='sidebar'>
        
        <h1>Tech Archives</h1>
<div class="left-box">
<ul>
  
  <li><a href="/tech/2012/10/">October 2012</a></li>
  
  <li><a href="/tech/2012/02/">February 2012</a></li>
  
  <li><a href="/tech/2012/01/">January 2012</a></li>
  
  <li><a href="/tech/2011/11/">November 2011</a></li>
  
  <li><a href="/tech/2011/07/">July 2011</a></li>
  
  <li><a href="/tech/2011/03/">March 2011</a></li>
  
  <li><a href="/tech/2011/01/">January 2011</a></li>
  
  <li><a href="/tech/2010/09/">September 2010</a></li>
  
  <li><a href="/tech/2010/04/">April 2010</a></li>
  
  <li><a href="/tech/2010/02/">February 2010</a></li>
  
  <li><a href="/tech/2010/01/">January 2010</a></li>
  
  <li><a href="/tech/2009/12/">December 2009</a></li>
  
  <li><a href="/tech/2009/11/">November 2009</a></li>
  
  <li><a href="/tech/2009/09/">September 2009</a></li>
  
  <li><a href="/tech/2009/08/">August 2009</a></li>
  
  <li><a href="/tech/2009/07/">July 2009</a></li>
  
  <li><a href="/tech/2009/06/">June 2009</a></li>
  
  <li><a href="/tech/2009/05/">May 2009</a></li>
  
  <li><a href="/tech/2009/03/">March 2009</a></li>
  
  <li><a href="/tech/2009/02/">February 2009</a></li>
  
  <li><a href="/tech/2009/01/">January 2009</a></li>
  
  <li><a href="/tech/2008/09/">September 2008</a></li>
  
  <li><a href="/tech/2008/07/">July 2008</a></li>
  
  <li><a href="/tech/2008/05/">May 2008</a></li>
  
  <li><a href="/tech/2008/04/">April 2008</a></li>
  
  <li><a href="/tech/2008/02/">February 2008</a></li>
  
  <li><a href="/tech/2007/12/">December 2007</a></li>
  
  <li><a href="/tech/2007/11/">November 2007</a></li>
  
  <li><a href="/tech/2007/10/">October 2007</a></li>
  
  <li><a href="/tech/2007/09/">September 2007</a></li>
  
  <li><a href="/tech/2007/08/">August 2007</a></li>
  
  <li><a href="/tech/2007/07/">July 2007</a></li>
  
  <li><a href="/tech/2007/06/">June 2007</a></li>
  
  <li><a href="/tech/2007/05/">May 2007</a></li>
  
  <li><a href="/tech/2007/04/">April 2007</a></li>
  
  <li><a href="/tech/2007/03/">March 2007</a></li>
  
  <li><a href="/tech/2007/02/">February 2007</a></li>
  
  <li><a href="/tech/2007/01/">January 2007</a></li>
  
  <li><a href="/tech/2006/12/">December 2006</a></li>
  
  <li><a href="/tech/2006/11/">November 2006</a></li>
  
  <li><a href="/tech/2006/10/">October 2006</a></li>
  
  <li><a href="/tech/2006/09/">September 2006</a></li>
  
  <li><a href="/tech/2006/08/">August 2006</a></li>
  
</ul>
</div>

        
      </div>
      <div id='main'>
        
<h2>MongoDB and Riak, In Context (and an apology)</h2>

<p>There has been quite a bit of <a href='http://news.ycombinator.com/item?id=3207203'>furor</a> and <a href='http://blog.schmichael.com/2011/11/05/failing-with-mongodb/'>excitement</a> on the Internet this week regarding some very public criticisms (and defenses) of MongoDB and its creators, <a href='http://10gen.com'>10gen</a>. Unfortunately, a <a href='http://luigimontanez.com/2011/mongodb-2.0-should-have-been-1.0/'>ghost from my recent past also resurfaced</a> as a result. Let me begin by apologizing to 10gen and its engineers for <a href='https://twitter.com/#!/sintaxi/status/65550206825005057'>what I said at JSConf</a>, and then I will reframe my comments in a more constructive form.</p>

<p><em>Mea culpa</em>. It&#8217;s way too easy in our industry to set up and knock down strawmen, as I did, than to convey messages of objective and constructive criticism. It&#8217;s also too easy, when you are passionate about what you believe in, to ignore the feelings and efforts of others, which I did. I have great respect for the engineers I have met from 10gen, Mathias Stern and Kyle Banker. They are friendly, approachable, helpful and fun to socialize with at conferences. Thanks for being stand-up guys.</p>

<p>Also, whether we like it or not, these kinds of public embarrassments have rippling effects across the whole NoSQL ecosystem. While Basho has tried to distance itself from other players in the NoSQL field, we cannot deny our origins, and the ecosystem as a &#8220;thing&#8221; is only about 3 years old. Are developers, technical managers and CTOs more wary of new database technologies as a result of these embarrassments? Probably. Should we continue to work hard to develop and promote alternative data-storage solutions? Absolutely.</p>

<h2 id='making_it_constructive'>Making it constructive</h2>

<p>For better or worse, many people consider MongoDB and Riak to be competitors. In reality, there are very few similarities between the products. <em>Then why are they in competition?</em> I personally believe this is because we have largely targeted our products at the same group of developers, those who work on web applications. So let&#8217;s take a moment and clarify the primary differences &#8212; both for understanding the technologies themselves and for unmuddying the current hoopla.</p>

<p>If I were asked why someone would use MongoDB, there are two clear reasons in my mind:</p>

<ol>
<li>MongoDB is <em>fast</em>. Say what you will about its durability (the context of my comment from JSConf) and the global write-lock (a consequence of its design, unfortunately), both writes and reads tend to be of low latency. Why? They are mostly in memory (via mmap).</li>

<li>MongoDB has very friendly APIs for developers. This is its biggest strength in my mind. Despite other things you would want to address before going to production, developers love to think of their data as lightly-structured documents. <em>It just makes sense</em>.</li>
</ol>

<p>In contrast, Riak&#8217;s strengths appeal more to operations folk, and developers who are cognizant or experienced in production operations:</p>

<ol>
<li>Riak is distributed and replicated <em>at its core</em>. There are no special nodes or services to run to scale out, every node you start and join acts equally among the cluster.</li>

<li>Riak has a strong focus on availability and durability in the face of failure. It will gladly sacrifice raw speed and consistency for the sake of staying available to your write load and making sure your writes get to disk.</li>
</ol>

<p>These differences are fundamental design decisions and have associated trade-offs. Because MongoDB&#8217;s design focus is to be a fast single-system database, other elements of its scale-out story are necessarily more complex &#8212; sharding, replica sets, etc. Because Riak&#8217;s focus is on distributed fault-tolerance and reliability, it necessarily sacrifices raw single-system performance. That&#8217;s not to say that MongoDB can&#8217;t scale out to large clusters well, or that Riak performs poorly in production, it is simply a recognition of the sacrifices necessary when designing a database system that addresses specific needs.</p>

<p>Could Urban Airship have used Riak instead of MongoDB for their bounded, in-memory dataset? Maybe. Would it have worked better for them than MongoDB? That is really difficult to tell.</p>

<h1 id='bringing_it_back_around'>Bringing it back around</h1>

<p>Now, if I&#8217;m so buddy-buddy with the 10gen guys, why did I say such an inflammatory thing in the first place? At Basho, we spend a decent amount of time evaluating and comparing other technologies so that we can understand where we stand in the market, to learn from others&#8217; perspectives, and to address the concerns and demands of potential customers. Naturally, this means we have examined MongoDB closely. MongoDB&#8217;s visibility, popularity, and developer-friendliness are things to be respected, even if we criticize the engineering decisions made by 10gen.</p>

<p>Shortly before JSConf, I had personally spent some time finding out ways to demonstrate that MongoDB will lose writes in the face of failure, to be used in a competitive comparison. Let&#8217;s just say that I was successful in doing so, despite recent improvements that 10gen has made. Unfortunately, I am not at liberty to share the results, nor do I think it would be constructive to this discussion. I&#8217;m sure 10gen has its own collection of competitive comparisons that are designed to shed a positive light on their product in contrast to Riak, it&#8217;s just how business works.</p>

<p>We also both know our system&#8217;s weaknesses and are working hard to fix them. 10gen&#8217;s most recent releases have demonstrated this fact, as I believe Basho&#8217;s recent releases have as well. (Have you tried out Riak 1.0? It&#8217;s awesome.)</p>

<h1 id='so_what_now'>So what now?</h1>

<p>The honeymoon phase of NoSQL is over. Will 10gen make the hard decisions it needs to make MongoDB is easier to scale out and have greater durability, while maintain its reputation for snappy performance? I believe they will. Will Basho improve Riak&#8217;s developer-friendliness and raw performance, while maintaining its reputation for simplicity and reliability in operations? I have no doubt.</p>

<p>So instead of gloating over each others&#8217; failures, let&#8217;s toast to the challenges and all become stronger, more proficient, and more successful as a result.</p>


      </div>
    </div>
    <div id='footer'>
      &copy; 2006-present Sean Cribbs &mdash; Powered by
      <a href='http://nanoc.stoneship.org'>nanoc3</a> &amp;
      <a href='http://pages.github.com'>github:pages</a>
      &mdash; Some icons by <a href="http://www.famfamfam.com/lab/icons/silk/">FamFamFam</a>
    </div>
    <script src="/javascripts/code_highlighter.js" type="text/javascript"></script>
    <script src="/javascripts/ruby.js" type="text/javascript"></script>
    <script src="/javascripts/erlang.js" type="text/javascript"></script>
    <script src="/javascripts/radius.js" type="text/javascript"></script>
    <script src="/javascripts/css.js" type="text/javascript"></script>
    <script src="/javascripts/haml.js" type="text/javascript"></script>
    <script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-4413101-1");
pageTracker._initData();
pageTracker._trackPageview();
</script>
    <script type="text/javascript">
//<![CDATA[
(function() {
		var links = document.getElementsByTagName('a');
		var query = '?';
		for(var i = 0; i < links.length; i++) {
			if(links[i].href.indexOf('#disqus_thread') >= 0) {
				query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
			}
		}
		document.write('<script charset="utf-8" type="text/javascript" src="http://disqus.com/forums/seancribbs/get_num_replies.js' + query + '"></' + 'script>');
	})();
//]]>
</script>

  </body>
</html>
