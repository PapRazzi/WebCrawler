   
<HTML>
<HEAD>
  <META NAME="DESCRIPTION" CONTENT="A newly developped
   fast in-situ permutation sort algorithm with time complexity
   O(n).">
  <META NAME="AUTHOR" CONTENT="Dr. Karl-Dietrich Neubert">
  <META NAME="KEYWORDS" CONTENT="sorting, linear time,
    O(n), in-situ, permutation,
    quick sort, heap sort, fast, fastest">

  <TITLE>FlashSort Algorithm</TITLE>

<BODY background="Pictures/MARB18.JPG">
  <TABLE width=100%>
    <TR>
      <TD width=100% bgcolor=green>

<br>  <! upper green line, start after bgcolor=green ------>
   <!----------- Tetrahedral Sphere left aligned ---------->
        <APPLET code="Polyhedron"
                codebase="AppPoly"
                width="54"
                height="36"
                align=left
                hspace=10>
          <PARAM name="Type" value="tetrahedron">
        </APPLET>
   <!----------- Tetrahedral Sphere right aligned --------->
        <APPLET code="Polyhedron"
                codebase="AppPoly"
                width="54"
                height="36"
                align=right
                hspace=10>
          <PARAM name="Type" value="tetrahedron">
        </APPLET>

      <FONT color=snow size="5">
          <center><b><tt>www.neubert.net</tt> - Dr. Neubert's Website</b>
          </center>
      </FONT>

      <FONT color=snow size="3">
<!-------   <center><b><tt>Everything can be improved!</b>   ---------->
<!-------  <center><b><tt>People only see what they are prepared to see.
                                           Emerson,1863 </b> ---------->
           <center><b><tt>The Entropy Reduction Laboratory </b>
           </center> 
     </FONT>
<br>  <! lower green line ------------------------------------>
        </FONT>
      </TD>
    </TR>
    <TR>
      <TD width=100% bgcolor=gold>
        <FONT face=Arial color=black size="5">
          <center><i>The FlashSort Algorithm</i></center>
        </FONT>
      </TD>
    </TR>
  </TABLE>

  <TABLE width=100% cellspacing=10 cellpadding=10>

    <!----------- Introduction   -------------->
    <TR>
      <TD width=0 bgrcolor=lightgrey>
        <FONT face=Arial><b>
          <br><br>
          <br>The Problem
          <br>of in-situ sorting with 
          <br>minimal auxiliary space
          <br>in minimal time.
        </b></FONT>
      </TD>
      <TD bgcolor=lightgrey>
          <H3><b> Introduction</b></H3>
          In "Mathematical Analysis of Algorithms",
          (Information Processing '71, North Holland Publ.'72)
          Donald Knuth remarked "... that research on computional
          complexity is an interesting way to sharpen our tools for
          more routine problems we face from day to day."
          <br>With respect to the sorting problem, <b> Knuth points out,</b>
          that <b>time effective <i>in-situ</i> permutation
          is inherently connected with the problem of finding the cycle
          leaders</b>, and  <i>in-situ</i> permutations could easily
          be performed in <i>O(n)</i> time if we would be allowed
          to manipulate <i>n</i> extra "tag" bits specifying
          how much of the permutation has been carried out
          at any time. <b> Without such tag bits,</b> he concludes
          "it seems reasonable to <b>conjecture</b> that <b> every algorithm
          will require for <i>in-situ</i> permutation at least <i>n log n</i>
          steps </b> on the average".
          <P>
          <b> Now this conjecture is shown not to be valid.</b> A new  
          efficient way to find cycle leaders is presented and 
          <i>in-situ</i> permutations can be performed in optimal time.
          <b> The algorithm FlashSort sorts in <i>O(n)</i>
          time without the manipulation  of <i>n</i> extra "tag" bits.</b>
          Here an auxiliary vector of only length <i>m</i> is required,
          where m is a small fraction of the number of elements <i>n</i>.
      </TD>
    </TR>

    <!----------- Introduction to the FlashSort algorithm  -------------->
    <TR>
      <TD width=0 bgrcolor=lightgrey>
        <FONT face=Arial><b>
                 <br><br>Classification
                 <br>    Accumulation
                 <br><br>run the  loops:
                 <br> - find cycle leader 
                 <br> - <i>in situ</i> permutation
                 <br><br>short range sorting </b> </FONT>
      </TD>
      <TD bgcolor=lightgrey>
       <H3><b> The FlashSort Algorithm</b></H3>
       FlashSort sorts <i>n</i> elements in <i>O(n)</i> time. Flash-Sort
       uses a vector <i>L(k)</i> of length <i>m</i> in a first step for  
       the classification of the elements of array <i>A</i>. Then,
       in a second step, the resulting counts are accumulated
       and the <i>L(k)</i> point to the class boundaries. Then the
       elements are sorted by <i>in situ</i> permutation. During the
       permutation, the <i>L(k)</i> are decremented by a unit step at each
       new placement of an element of class <i>k</i> in the array <i>A</i>.
       A crucial aspect of FlashSort is that for identifying new cycle
       leaders. A cycle ends, if the the vector <i>L(k)</i> points to the
       position of an element below the classboundary of class <i>k</i>.
       The new cycle leader is the element situated in the lowest position
       complying to the complimentary condition, i.e. for which <i>L(k)</i>
       points  to a position with <nobr> <i>L(k(A(i))) >= i.</i></nobr>  
       Evidently, in addition to the array <i>A</i> of length <i>n</i> which
       holds the <i>n</i> elements to be sorted, the only  auxiliary vector
       is the <i>L(k)</i>-vector. The size of this vector is equal to the
       number <i>m</i> of classes which is small compared to <i>n,</i>
       e.g. <i>m</i> typically may be set to <i> m</i>=0.1 <i>n</i> in case of floating point 
       numbers.
       <br>
       Finally,a small number of partially distinguishable elements are
       sorted locally within their classes either by recursion or by a simple
       conventional sort algorithm.
      </TD>
    </TR>
   <!----------- Detailed desription   -------------->
    <TR>
      <TD width=0 bgrcolor=lightgrey>
        <FONT face=Arial><b>In these papers <br>you find <br>
              a more detailed description <br> of the algorithm. </b></FONT>
      </TD>
      <TD bgcolor=lightgrey>
        <UL>
                  <br>
          <LI><i> Karl-Dietrich Neubert</i>
                  <a href="Download/flashpap.doc"> The FlashSort Algorithm </a>
                  <br>This is an MS 6.0 Word document as 
                  published in the Proceedings of the <br> 
                  <a href="http://dec.bournemouth.ac.uk/forth/euro/ef97.html">
                  euroFORTH'97</a>
                  -Conference, Oxford, England,Sept.26-28 1997
                  <br><br>
                         
          <LI><i> Karl-Dietrich Neubert</i>,
                  <a href="Flapaper/9802n.htm"> FlashSort1 Algorithm</a> in
                  <br>
                  <a href="http://www.ddj.com"> Dr. Dobb's Journal </a>
                  <img src="/Banners/dobbs.gif"  
                  WIDTH=220 HEIGHT=50 ALIGN=TOP >
                  Feb.1998,p.123
                  <br>
CLICK <a href="http://www.commission-junction.com/track/track.dll?AID=51220&PID=304174&URL=https%3A%2F%2Fwow%2Emfi%2Ecom%2Fcirc%2Fddj%2F2CJ1new%2Ehtml">HERE 
</a> TO SUBSCRIBE TO DDJ<img src="http://www.commission-junction.com/banners/tracker.exe?AID=51220&PID=304174&banner=0.gif" height=1 width=1 border=0>

    <!-------- Demonstrations  -------------->
    <TR>
      <TD width=0 bgrcolor=lightgrey>
        <FONT face=Arial><b>A collection of <br> FlashSort demos</b></FONT>
      </TD>
      <TD bgcolor=lightgrey>
      <UL>
        For animations of the FlashSort principle and runtime, select <br>
        <a href="Flademos/FLADemos.html">Collection of FlashSort demos</a>
      </UL> 
    </TR>

    <!-------- goto Collection of FlashSort codes  -------------->
    <TR>
      <TD width=0 bgrcolor=lightgrey>
        <FONT face=Arial><b>A collection of <br>FlashSort codes</b></FONT>
      </TD>
      <TD bgcolor=lightgrey>
      <UL> 
        For codes in various languages and various modifications
        of the FlashSort algorithm see 
        <br><a href="Flacodes/FLACodes.html">Collection of FlashSort codes</a>.<br>
      </UL>
    </TR>




        <!----------- General version   -------------->
<!---------------------------
             comment --------
    <TR>
      <TD width=0 bgrcolor=lightgrey>
        <FONT face=Arial><b>General<br>version</b></FONT>
      </TD>
      <TD bgcolor=lightgrey>
        <H3>The more general Version of FlashSort</H3>
        <P>
        For real life applications, a recursive version of FLASH-SORT
        is available. With that version, within the limits of available
        memory, any number of strings of any length and any number of
        keys with independent selectable collation sequences for any
        sort order of columns may be sorted in optimal run time. As an
        example, sorting on a 133 MHz PC 100 000 strings of 50 bytes length with a 50
        byte key takes about 4.6 sec, sorting 1000 000 strings of the
        same length and same number of keys requires 46 sec.
      </TD>
    </TR>
--------------------------------------------------- end of comment --->

                  
                
        </UL>
      </TD>
    </TR>

    <!----------- Back   -------------->
    <TR>
      <TD width=0 bgrcolor=lightgrey>
        <FONT face=Arial><b>Back</b></FONT>
      </TD>
      <TD bgcolor=lightgrey>
        <UL>
        To go back to the Welcome page click
        <a href="http://www.neubert.net">here</a>.
        </UL>  
      </TD>
    </TR>

  </TABLE>
  <center> <img src="http://neubert.net/counter"> </center>
  <P>
  <small><center>
    This page and each part of it Copyright &#169 1998
    <a href="Discuss/karl-dietrich.html">Karl-Dietrich Neubert</a>.<br>
    All Rights Reserved<br>
    Design by
    <a href="Discuss/vladimir.html">Vladimir Marek</a>.<br>
    Last update of the page: March 18, 2003    
  </center></small>
  <hr>

</HTML>