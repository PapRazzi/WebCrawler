<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="ja-JP">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=EUC-JP">
	<meta name="generator" content="tDiary 2.2.0">
	<meta http-equiv="Last-Modified" content="Mon, 15 Nov 2010 15:10:01 GMT">
	<meta http-equiv="Content-Script-Type" content="text/javascript; charset=EUC-JP">
	<meta name="author" content="Yukihiro -matz- Matsumoto">
	
	<link rel="prev" title="前の日(11-12)" href="http://www.rubyist.net/~matz/1112.html">
	<link rel="next" title="次の日(11-14)" href="http://www.rubyist.net/~matz/1114.html">
	<link rel="start" title="最新" href="http://www.rubyist.net/~matz/">
	
	
	
	<meta http-equiv="content-style-type" content="text/css">
	<link rel="stylesheet" href="theme/base.css" type="text/css" media="all">
	<link rel="stylesheet" href="theme/sagegreen/sagegreen.css" title="sagegreen" type="text/css" media="all">
	<title>Matzにっき(11-13[長年日記])</title>
	
  <script type="text/javascript">
  <!--
  // http://www.din.or.jp/~hagi3/JavaScript/JSTips/Mozilla/
  // _dom : kind of DOM.
  //        IE4 = 1, IE5+ = 2, NN4 = 3, NN6+ = 4, others = 0
  _dom = document.all?(document.getElementById?2:1)
                     :(document.getElementById?4
                     :(document.layers?3:0));
  var _calendar3_popElement = null;
  var _calendar3_popCount = 0;

  if (document.compatMode){
    if (_dom==2 && document.compatMode=="CSS1Compat") _dom = 2.5;
  } // Win IE6

  function getLeft(div){
    result = 0;
    while (1){
      div = div.offsetParent;
      result += div.offsetLeft;
      if (div.tagName=="BODY") return result;
    }
  }

  function getTop(div){
    result = 0;
    while (1){
      div = div.offsetParent;
      result += div.offsetTop;
      if (div.tagName=="BODY") return result;
    }
  }

  function moveDivTo(div,left,top){
    if(_dom==4){
      div.style.left=left+'px';
      div.style.top =top +'px';
      return;
    }
    if(_dom==2.5 || _dom==2 || _dom==1){
      div.style.pixelLeft=left;
      div.style.pixelTop =top;
      return;
    }
    if(_dom==3){
      div.moveTo(left,top);
      return;
    }
  }

  function moveDivBy(div,left,top){
    if(_dom==4){
      div.style.left=div.offsetLeft+left;
      div.style.top =div.offsetTop +top;
      return;
    }
    if(_dom==2.5 || _dom==2){
      div.style.pixelLeft=div.offsetLeft+left;
      div.style.pixelTop =div.offsetTop +top;
      return;
    }
    if(_dom==1){
      div.style.pixelLeft+=left;
      div.style.pixelTop +=top;
      return;
    }
    if(_dom==3){
      div.moveBy(left,top);
      return;
    }
  }

  function getDivLeft(div){
    if(_dom==2.5) return div.offsetLeft+getLeft(div);
    if(_dom==4 || _dom==2) return div.offsetLeft;
    if(_dom==1)            return div.style.pixelLeft;
    if(_dom==3)            return div.left;
    return 0;
  }

  function getDivTop(div){
    if(_dom==2.5) return div.offsetTop+getTop(div);
    if(_dom==4 || _dom==2) return div.offsetTop;
    if(_dom==1)            return div.style.pixelTop;
    if(_dom==3)            return div.top;
    return 0;
  }

  function getDivWidth (div){
    if(_dom==4 || _dom==2.5 || _dom==2) return div.offsetWidth;
    if(_dom==1)            return div.style.pixelWidth;
    if(_dom==3)            return div.clip.width;
    return 0;
  }

  function getDivHeight(div){
    if(_dom==4 || _dom==2.5 || _dom==2) return div.offsetHeight;
    if(_dom==1)            return div.style.pixelHeight;
    if(_dom==3)            return div.clip.height;
    return 0;
  }

  function popup(target,element,notitle) {
    _calendar3_popCount++;
    popdownNow();
    if (navigator.appName=='Microsoft Internet Explorer') {
      moveDivTo(element,getDivLeft(target)+getDivWidth(target),getDivTop(target)+getDivHeight(target)*13/8);
    } else {
      moveDivTo(element,getDivLeft(target)+getDivWidth(target)/2,getDivTop(target)+(getDivHeight(target)*2)/3);
    }
    element.style.display="block";
    notitle.title="";
  }

  function popdown(element) {
    _calendar3_popElement=element;
    setTimeout('popdownDelay()', 2000);
  }

  function popdownDelay() {
    _calendar3_popCount--;
    if (_calendar3_popCount==0) {
      popdownNow();
    }
  }

  function popdownNow() {
    if (_calendar3_popElement!=null) {
      _calendar3_popElement.style.display="none";
      _calendar3_popElement=null;
    }
  }
  // -->
</script>
	<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
	</script>
	<script type="text/javascript">
	_uacct = "UA-58636-2";
	urchinTracker();
	</script>
	<link rel="alternate" type="application/rss+xml" title="RSS(with comments and spams)" href="http://www.rubyist.net/~matz/comments.rdf">
	<link rel="alternate" type="application/rss+xml" title="RSS" href="http://www.rubyist.net/~matz/index.rdf">
	<meta name="robots" content="noindex,follow">
</head>
<body>


<div class="adminmenu">
<span class="adminmenu"><a href="http://www.rubyist.net/~matz/1112.html">&laquo;前の日(11-12)</a></span>
<span class="adminmenu"><a href="http://www.rubyist.net/~matz/">最新</a></span>
<span class="adminmenu"><a href="http://www.rubyist.net/~matz/1114.html">次の日(11-14)&raquo;</a></span>
<span class="adminmenu"><a href="https://www.rubyist.net/~matz/update.rb" rel="nofollow">追記</a></span>
</div>

<h1>Matzにっき</h1>
<div class="right">
<form method="get" action="rast-search.rb" class="grepform">
<input type="text" name="query" size="20" value="" class="search">
<input type="submit" value="検索"></p>
</form>
</div>
<span class="calendar-prev-month"><a href="http://www.rubyist.net/~matz/200310.html">&lt;&lt;</a></span>
<span class="calendar-current-month"><a href="http://www.rubyist.net/~matz/200311.html">2003/11</a>/</span>
<span class="calendar-normal"><a class="calendar-saturday">1</a></span>
<span class="calendar-normal"><a class="calendar-sunday">2</a></span>
<span class="calendar-normal"><a class="calendar-weekday">3</a></span>
<span class="calendar-normal"><a class="calendar-weekday">4</a></span>
<span class="calendar-normal"><a class="calendar-weekday">5</a></span>
<span class="calendar-normal"><a class="calendar-weekday">6</a></span>
<span class="calendar-normal"><a class="calendar-weekday">7</a></span>
<span class="calendar-normal"><a class="calendar-saturday">8</a></span>
<span class="calendar-normal"><a class="calendar-sunday">9</a></span>
<span class="calendar-normal"><a class="calendar-weekday">10</a></span>
<span class="calendar-normal"><a class="calendar-weekday">11</a></span>
<span class="calendar-normal"><a class="calendar-weekday">12</a></span>
<span class="calendar-day" id="target-13" onmouseover="popup(document.getElementById('target-13'),document.getElementById('popup-13'), document.getElementById('title-13'));" onmouseout="popdown(document.getElementById('popup-13'));">
  <a class="calendar-weekday" id="title-13" title="1. Texas A&amp;amp;M University
" href="http://www.rubyist.net/~matz/20031113.html">13</a>
  <span class="calendar-popup" id="popup-13">
    <a href="http://www.rubyist.net/~matz/20031113.html#p01" title="ホテルで朝食をすませた後、Stroustrup教授の車で大学まで。 大学を一周して見物させてもらう。 しかし、広い大学だ。筑波大もい..">1</a>. Texas A&amp;M University
<br>
  </span>
</span>
<span class="calendar-normal"><a class="calendar-weekday">14</a></span>
<span class="calendar-normal"><a class="calendar-saturday">15</a></span>
<span class="calendar-normal"><a class="calendar-sunday">16</a></span>
<span class="calendar-normal"><a class="calendar-weekday">17</a></span>
<span class="calendar-normal"><a class="calendar-weekday">18</a></span>
<span class="calendar-normal"><a class="calendar-weekday">19</a></span>
<span class="calendar-normal"><a class="calendar-weekday">20</a></span>
<span class="calendar-normal"><a class="calendar-weekday">21</a></span>
<span class="calendar-normal"><a class="calendar-saturday">22</a></span>
<span class="calendar-normal"><a class="calendar-sunday">23</a></span>
<span class="calendar-normal"><a class="calendar-weekday">24</a></span>
<span class="calendar-normal"><a class="calendar-weekday">25</a></span>
<span class="calendar-normal"><a class="calendar-weekday">26</a></span>
<span class="calendar-normal"><a class="calendar-weekday">27</a></span>
<span class="calendar-normal"><a class="calendar-weekday">28</a></span>
<span class="calendar-normal"><a class="calendar-saturday">29</a></span>
<span class="calendar-normal"><a class="calendar-sunday">30</a></span>
<span class="calendar-next-month"><a href="http://www.rubyist.net/~matz/200312.html">&gt;&gt;</a></span>




<hr class="sep">


	
<div class="day">
<h2><span class="date">
<a href="http://www.rubyist.net/~matz/20031113.html">2003-11-13</a>
</span> 
<span class="title"></span></h2>

<div class="body">

<div class="section">

<h3><a href="http://www.rubyist.net/~matz/20031113.html#p01"><span class="sanchor">_</span></a> [<a href="http://www.rubyist.net/~matz/?year=2003;month=4Q;category=Ruby">Ruby</a>]Texas A&amp;M University</h3>
<p>ホテルで朝食をすませた後、Stroustrup教授の車で大学まで。
大学を一周して見物させてもらう。</p>
<p>しかし、広い大学だ。筑波大もいいかげん大きいなあと思っていたけど、
ここはその何倍も広い。冗談のような大きさのスタジアムが印象的だった。</p>
<p>Bjarneいわく「キリスト教はテキサス州2番目の宗教だ。最大はフットボール」だそうで、
熱の入れ方は半端ではないそうだ。</p>
<p>午前中はBjarneの紹介で、Salih Yurttas教授と会う。
「今度は授業でPythonを扱おうと思ったけど、Rubyにしようかなあ」とおっしゃっていた。
言語好き同士話が弾む。</p>
<p>昼食をBjane、Salihと一緒にとった後、今度はComputer Science Dapartmentのディレクター、
Valerie Taylor教授に紹介される。</p>
<p>しかし、いくらわざわざ海外から来た客だとはいえ、
実質的に無名な私にきちんと時間を割いてくれる丁寧な扱いに感銘を受ける。
しかも、コンピュータ科学部のボスまで。感謝。</p>
<p>Valerieは</p>
<blockquote>
私はずっとAWKなの。
研究してるシステムはPerlを使ってるけど、開発は学生がやってるから。
</blockquote>

<p>とのこと。</p>
<p>今回は夕べのディナー、今日の朝食、昼食とずっとBjarneと一緒だった。
せっかくの機会なので聞いた話をまとめておこう。思い出せることを端から書き上げたので、
順不同、時系列無視なのであしからず。</p>
<blockquote>
<p><b>Matz(以下M):</b> C++にはSimulaの影響が見えますけど、他のオブジェクト指向言語、
たとえばSmalltalkからは影響を全然受けていないんですか？</p>
<p><b>Bjarne(以下B):</b> 受けてないね。
私は元々(ケンブリッジ大の大学院で)分散システムの研究をしてたんだけど、
分散システムのシミュレータを書くのにSimulaを使ったんだ。
ところがSimulaは遅すぎて結局BCPLで書き直したんだけどね。
こういう経緯があるんでCにSimulaの機能を追加したC with Classを作り、
最終的にはC++になったというわけなんだ。</p>
<p><b>M:</b> Javaについてどう思いますか？ (Aarhusでも聞いたけど)</p>
<p><b>B:</b> 聞かないでくれ。もしPositiveなことを言えば、そんなので満足してるかって言われるし、
Nagativeなことを言えば波乱が起きるし。
15年くらい前にはObjective-Cの連中といろいろあったし。
言語論争は嫌いだ。</p>
<p><b>M:</b> そのObjective-CのBrad Coxが今JavaとRubyを使ってるっていうんですから皮肉ですよね。
今なにを研究してるんですか。</p>
<p><b>B:</b> 今は他のプロジェクトを助けたり、会議したりしてるんだ。院生を指導したりもしているよ。
こっち来てから１年くらいにしかならないんで本格的な活動はまだだね。
また分散の研究をしようかなあって思ってるんだ。
あと、大学っていうのは研究だけじゃなく教育もやるところだからね。それについても活動しているよ。</p>
<p><b>M:</b> というと？</p>
<p><b>B:</b> 来年そうそうから学部生の授業を持つことになってるんだ。C++を教えるんだけど。
で、いい教科書がなくてねえ。困ってるんだ。
C++を使った教科書はどれも分厚いばっかりで面白くないし。
たとえばこれなんか「回文チェック」って例題のために、
擬似コードでの回文とはなにかって説明に2ページ、C++のプログラムにまた2ページ使ってるんだよ。
テンプレートを使えばこんなのワンライナーなのに(と黒板に書きはじめる)。
おまけにこれなら任意の型のベクターの回文チェックができる。</p>
<p><b>B:</b> 今は学生のためにGUI機能を設計してるんだ。
今時の授業じゃGUIを使わないわけにはいかないけど、
私が授業でやりたいのはツールキットの説明じゃない。
既存のツールキットをそのまま使ったらその説明時間だけで授業が終わっちゃうからね。
ダイアログを呼び出す同期呼び出しとポーリングを使った非同期呼び出しができる単純なものを考えてるんだ。
やっぱり複雑過ぎるものは駄目だからね(と、設計を黒板に書きはじめる)。</p>
</blockquote>

<p>他にもいろいろと話したような気がするのだが、忘れてしまった。もったいない。
録音でもしておくべきだったか。大半はアメリカ、日本、デンマーク、トルコ(Salih教授の出身地)の
文化・慣習の違いについてとかだったような気がするけど。</p>
<p><a href="http://www.amazon.co.jp/exec/obidos/redirect?tag=ruby-22%26link_code=xm2%26camp=2025%26creative=165953%26path=http://www.amazon.co.jp/gp/redirect.html%253fASIN=0201543303%2526tag=ruby-22%2526lcode=xm2%2526cID=2025%2526ccmID=165953%2526location=/o/ASIN/0201543303%25253FSubscriptionId=1CVA98NEF1G753PFESR2"><img class="right" src="http://images.amazon.com/images/P/0201543303.01._SCMZZZZZZZ_.jpg"
height="160" width="107"
alt="" title="">
</a>
しかし、Bjarneはえらく頭が良くて、しかも(私の視点から見ても)言語設計に対して「正しい思想」を
持っているようなのに、C++がえらくアレなのはいったいどういうことだろうか。
やはりC++が志向する領域が本質的に複雑で、その複雑な状況に対応するためには言語も複雑にならざるをえなかったということなのだろうか。
もちろんC++の問題の本質は使い方によるのであるが、そういう使い方ができてしまうのも問題といえば問題なのだが。</p>
<p><a href="http://www.amazon.co.jp/exec/obidos/redirect?tag=ruby-22%26link_code=xm2%26camp=2025%26creative=165953%26path=http://www.amazon.co.jp/gp/redirect.html%253fASIN=0201543303%2526tag=ruby-22%2526lcode=xm2%2526cID=2025%2526ccmID=165953%2526location=/o/ASIN/0201543303%25253FSubscriptionId=1CVA98NEF1G753PFESR2">The Design and Evolution of C++</a>を(サイン入りで)いただいたので、
ちょっと研究してみることにしよう。</p>
<p>夕方からは今回の招待のメイン、招待セミナー。
今回のスライドは<a href="http://www.rubyist.net/~matz/slides/tamu/">ここ</a>。
下手な英語ではあったが、そんなに悪い話はしなかったと思うけど、あんまり盛り上がらなかったなあ。</p>
<p>その後、Austinに移動。運転手は昨日と同じ女性だ。今夜は１時間半ほどで到着。
やっぱり途中は寝ていた。乗り物に乗るとすぐ寝ちゃうなあ。</p>
<p>ホテルでRich Kilmer、Chad Fowler、David Alan Blackたちに会う。
少しおしゃべりしてから部屋へ。</p>
<p>で、部屋でLinux Magazineの原稿を書くのであった。</p>
<p>追記:</p>
<p>ツッコミをいただいたので返事しておく。</p>
<p>まず、<a href="http://www.rubyist.net/~matz/20031113.html#c03" title="[KL] Javaはともかくとして「Rubyについてどう思うか」という話題への到達は必至ではなかったかと思うのですがどうでしょ..">KLさん</a>。Rubyについて聞かなかったのは、
<b>彼がRubyについて名前以外なんにも知らなかった</b>からです。
私がセミナーで説明した後ではある程度分かって「面白い」と言ってくれましたが、
その後すぐ別れちゃったし。つっこんで聞く機会はありませんでした。</p>
<p>次に、<a href="http://www.rubyist.net/~matz/20031113.html#c04" title="[とおりすがり] なんで「Javaについてどうか」って質問するんでしょうか？ 個人的には、まつもと氏がJavaを嫌い(?)なのを自分の..">とおりすがりさん</a>。
「私がJavaが嫌いだからBjarneからネガティブな発言を引き出したがっている」という推理は
当たっていないように思います。だって嫌いじゃないもん。
興味が持てないだけで。たぶんBjarneも同じ意見だと思います。</p>

</div>

<div style="text-align: center;"><script type="text/javascript"><!--
google_ad_client = "pub-1068577065829336";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_channel ="1130103482";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>
</div>

<div class="comment">

		<div class="caption">本日のツッコミ(全8件) [<a href="http://www.rubyist.net/~matz/20031113.html#c">ツッコミを入れる</a>]</div>
		<div class="commentshort">
				<p><a href="http://www.rubyist.net/~matz/20031113.html#c01"><span class="canchor">_</span></a>
				<span class="commentator">とおりすがり</span>&nbsp;[http://hp.vector.co.jp/authors/VA000092/jokes/strup.html と..]</p>
				<p><a href="http://www.rubyist.net/~matz/20031113.html#c02"><span class="canchor">_</span></a>
				<span class="commentator">y</span>&nbsp;[http://www.research.att.com/~bs/bs_faq.html#IEEE  Of cours..]</p>
				<p><a href="http://www.rubyist.net/~matz/20031113.html#c03"><span class="canchor">_</span></a>
				<span class="commentator">KL</span>&nbsp;[Javaはともかくとして「Rubyについてどう思うか」という話題への到達は必至ではなかったかと思うのですがどうでしょ..]</p>
				<p><a href="http://www.rubyist.net/~matz/20031113.html#c04"><span class="canchor">_</span></a>
				<span class="commentator">とおりすがり</span>&nbsp;[なんで「Javaについてどうか」って質問するんでしょうか？ 個人的には、まつもと氏がJavaを嫌い(?)なのを自分の..]</p>
				<p><a href="http://www.rubyist.net/~matz/20031113.html#c05"><span class="canchor">_</span></a>
				<span class="commentator">とおりすがり2</span>&nbsp;[自他共に認める日本の言語オタクが、現在これほど広く使われている言語に対して「興味がもてない」としらっと言ってしまうと..]</p>
				<p><a href="http://www.rubyist.net/~matz/20031113.html#c06"><span class="canchor">_</span></a>
				<span class="commentator">まつもと</span>&nbsp;[「好きじゃない」と「嫌い」の区別をしない言語感覚の人にとってはそうなんでしょうね。私自身は「嫌いな言語」という言葉は..]</p>
				<p><a href="http://www.rubyist.net/~matz/20031113.html#c07"><span class="canchor">_</span></a>
				<span class="commentator">AC</span>&nbsp;[嫌いな言語リストと好きな言語リストをどっかに書いておけば解決する話でしょ。 言語オタクだからと言って自然言語も堪能と..]</p>
				<p><a href="http://www.rubyist.net/~matz/20031113.html#c08"><span class="canchor">_</span></a>
				<span class="commentator">村田拓哉</span>&nbsp;[教授のホームページになぜ、言語の比較をしないのか書いてあります。 http://www.research.att.c..]</p>
		</div>
</div>



	<div class="comment trackbacks">
		<div class="caption">
			[TrackBack URL: <a href="http://www.rubyist.net/~matz/tb.rb/20031113">http://www.rubyist.net/~matz/tb.rb/20031113</a>]
		</div>
		<div class="commentshort trackbackshort">
		</div>
	</div>





		<div class="referer">
		
		</div>
</div>


	<hr class="sep">
	
<div class="day">
<h2><span class="date">
<a href="http://www.rubyist.net/~matz/20041113.html">2004-11-13</a>
</span> 
<span class="title"></span></h2>

<div class="body">

<div class="section">

<h3><a href="http://www.rubyist.net/~matz/20041113.html#p01"><span class="sanchor">_</span></a> [<a href="http://www.rubyist.net/~matz/?year=2003;month=4Q;category=%B2%C8%C2%B2">家族</a>]息子の自転車</h3>
<p>小学校1年生の息子は最近まで自転車にさっぱり興味がなかったのだが、
とうとう自転車に乗ることを覚える気になったらしい。</p>
<p>「やる気になった時にやらせる」のはうちの教育方針なので、
さっそく自転車を買いに行くことにする。
自分で自分の自転車を決めることそのものが、
脳味噌の普段使っていない部分を刺激するらしく、頭から煙が出そうなくらい悩んでいた。</p>
<p>あちこちの店を回ってさんざん悩んだ揚げ句、
BMX風の22インチ車を購入することにした。普通、もうちょっと子供っぽいのにするんじゃないのか。</p>
<p>まあ、いいか。</p>

</div>

<div style="text-align: center;"><script type="text/javascript"><!--
google_ad_client = "pub-1068577065829336";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_channel ="1130103482";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>
</div>

<div class="comment">

	<div class="caption">[<a href="http://www.rubyist.net/~matz/20041113.html#c">ツッコミを入れる</a>]</div>
</div>



	<div class="comment trackbacks">
		<div class="caption">
			[TrackBack URL: <a href="http://www.rubyist.net/~matz/tb.rb/20041113">http://www.rubyist.net/~matz/tb.rb/20041113</a>]
		</div>
		<div class="commentshort trackbackshort">
		</div>
	</div>





		<div class="referer">
		
		</div>
</div>


	<hr class="sep">
	
<div class="day">
<h2><span class="date">
<a href="http://www.rubyist.net/~matz/20051113.html">2005-11-13</a>
</span> 
<span class="title"></span></h2>

<div class="body">

<div class="section">

<h3><a href="http://www.rubyist.net/~matz/20051113.html#p01"><span class="sanchor">_</span></a> [<a href="http://www.rubyist.net/~matz/?year=2003;month=4Q;category=%B6%B5%B2%F1">教会</a>] 監督不在</h3>
<p>司会。あまりうわずらなくなってきた。</p>
<p>副監督の一人は岡山、監督も聖餐会終了後は監督訓練集会で岡山。
取り残された私は少々不安だったが、とくになにごともなく終了。</p>
<p>集会終了後、面接。いろいろと懸念事項を聞く。
教会といえどもいろんな人の集まりなので、
心配事やら、問題やらいろいろあるものだ。</p>
<p>依頼されたことは手配しておく。</p>

</div>

<div style="text-align: center;"><script type="text/javascript"><!--
google_ad_client = "pub-1068577065829336";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_channel ="1130103482";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>
</div>

<div class="comment">

	<div class="caption">[<a href="http://www.rubyist.net/~matz/20051113.html#c">ツッコミを入れる</a>]</div>
</div>



	<div class="comment trackbacks">
		<div class="caption">
			[TrackBack URL: <a href="http://www.rubyist.net/~matz/tb.rb/20051113">http://www.rubyist.net/~matz/tb.rb/20051113</a>]
		</div>
		<div class="commentshort trackbackshort">
		</div>
	</div>





		<div class="referer">
		
		</div>
</div>


	<hr class="sep">
	
<div class="day">
<h2><span class="date">
<a href="http://www.rubyist.net/~matz/20061113.html">2006-11-13</a>
</span> 
<span class="title"></span></h2>

<div class="body">

<div class="section">

<h3><a href="http://www.rubyist.net/~matz/20061113.html#p01"><span class="sanchor">_</span></a> バッテリー復活</h3>
<p>結局、以前よくお世話になってた整備工場に電話して来てもらう。
わざわざ出向いてもらって、交換までお願いしたのに、
バッテリーの代金だけで済ませてもらった。</p>
<p>ありがたい。</p>

</div>
<div class="section">

<h3><a href="http://www.rubyist.net/~matz/20061113.html#p02"><span class="sanchor">_</span></a> [<a href="http://www.rubyist.net/~matz/?year=2003;month=4Q;category=%B8%B6%B9%C6">原稿</a>] 日経Linux 2007年1月号</h3>
<p>「オープンクラス」完了。疲れた。</p>

</div>
<div class="section">

<h3><a href="http://www.rubyist.net/~matz/20061113.html#p03"><span class="sanchor">_</span></a> 緊急持ち出し</h3>
<p>家庭の夕べで緊急持ち出しカバンの中身をチェック。</p>
<p>前回チェックしてから数ヶ月にしかならないのに、
虫がついてたり、消費期限が過ぎたりで、だめになってるものがあったり。
なかなかメンテナンスが面倒なものだ。</p>

</div>
<div class="section">

<h3><a href="http://www.rubyist.net/~matz/20061113.html#p04"><span class="sanchor">_</span></a> <a href="http://colemak.com/">Colemak keyboard layout: ergonomic, fast and easy to learn QWERTY/Dvorak alternative</a></h3>
<p>QWERTYに似てるけど、ずっと良いキー配列。</p>
<ul>
<li>QWERTYからの変化が少ない</li>
<li>Dvorakより移行が簡単</li>
<li>効率はDvorakと同等</li>
</ul>
<p>なんだそうだ。具体的には以下のようになってる。</p>
<pre>TAB Q W F P G J L U Y ; [ ] \
 BS  A R S T D H N E I O '
SHIFT Z X C V B K M , . /</pre>
<p>個人的には大量に文書を入力する日本語に対して「きゅうり改」があるから、
そんなに魅力的ではないけど、英文をたくさん入力する人には効果的、かも。</p>

</div>

<div style="text-align: center;"><script type="text/javascript"><!--
google_ad_client = "pub-1068577065829336";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_channel ="1130103482";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>
</div>

<div class="comment">

		<div class="caption">本日のツッコミ(全2件) [<a href="http://www.rubyist.net/~matz/20061113.html#c">ツッコミを入れる</a>]</div>
		<div class="commentshort">
				<p><a href="http://www.rubyist.net/~matz/20061113.html#c02"><span class="canchor">_</span></a>
				<span class="commentator">eisuu-kana</span>&nbsp;[日本語用には、きゅうり改以降も多くのキー配列が提案されていますよ。 英文用に最適化されたものは、和文用にはやはり少し..]</p>
				<p><a href="http://www.rubyist.net/~matz/20061113.html#c03"><span class="canchor">_</span></a>
				<span class="commentator">ＭＭＸ</span>&nbsp;[英字最適では UK が低頻度扱いで、ローマ字には最適になりません。右手のキーが右手のままで移行しやすそう。 back..]</p>
		</div>
</div>



	<div class="comment trackbacks">
		<div class="caption">
			[TrackBack URL: <a href="http://www.rubyist.net/~matz/tb.rb/20061113">http://www.rubyist.net/~matz/tb.rb/20061113</a>]
		</div>
		<div class="commentshort trackbackshort">
		</div>
	</div>





		<div class="referer">
		
		</div>
</div>


	<hr class="sep">
	
<div class="day">
<h2><span class="date">
<a href="http://www.rubyist.net/~matz/20091113.html">2009-11-13</a>
</span> 
<span class="title"></span></h2>

<div class="body">

<div class="section">

<h3><a href="http://www.rubyist.net/~matz/20091113.html#p01"><span class="sanchor">_</span></a> [<a href="http://www.rubyist.net/~matz/?year=2003;month=4Q;category=%B8%C0%B8%EC">言語</a>] <a href="http://golang.org/">The Go Programming Language</a></h3>
<p>もう知っている人は知っているGoogleからのシステムプログラミング新言語Go。</p>
<p>すっかり祭りには乗り遅れた感があるけど、少しだけコメントをつけておこう。</p>
<h4>目次</h4>
<ul>
<li>言語仕様</li>
<li>言語実装</li>
<li>技術的でない話</li>
<li>まとめ</li>
</ul>
<h4>言語仕様</h4>
<p>総合的に見て、非常にバランスを考えているように思える。
JavaやC++のような複雑さを排して、シンプルに徹する一方、
言語好きを刺激するような新しいアイディアをそこかしこに配置している。</p>
<p>特徴である「コンパイルが高速」というのも、
このシンプルな言語仕様が寄与していると思われる。</p>
<p>個人的に、注目したのはオブジェクト指向機能と、並列機能。</p>
<p>interfaceによる、継承のないオブジェクト指向(duck typing)は、かなり私好みである。
昔からこういう言語が欲しかった。interfaceのみ動的結合を許すというのも
Satherを思い起こさせて好印象。</p>
<p>ただし、私が見た範囲内では、実装の継承(共有)は提供されないみたいなので、
Javaのinterface同様、コンポジションを強制されることになるので、
そこは残念。</p>
<p>それから、goroutineなる並列実行機能。
Erlangを意識してるのかな。でも、それ以上に使いやすそうな印象。</p>
<pre>go 式</pre>
<p>だけで並列実行が開始できるのは大胆である。
ほとんどのオブジェクトが値渡し(コピーされる)とあいまって、
効率よく並列実行できそう。</p>
<p>あと、多値を活用しているもの面白い。
成功したかどうかを2番目の値で返すところとかもErlangを思い起こさせる。</p>
<p>「逆転した型宣言」は、はじめはギョッとしたけど、
慣れたら結構良いかもしれない。</p>
<h4>言語実装</h4>
<p>コマンド名！ 8cとかなんだよって感じ。</p>
<p>ソースコードを眺めたが、正直、一番興味があるランタイムの部分は
よくわからなかった。だいぶ慣れないとなにがどこにあるのかよくわからない。</p>
<p>GCはシンプルなマーク・スイープだった。</p>
<p>goroutineのsegmented stackの実装に興味があったのだが、
まだみつからず。たぶん、そこはランタイムじゃなくて、
コンパイラそのものを見ないとわかんないんだろうな。</p>
<h4>技術的でない話</h4>
<p>「Goが登場したからには(Java/C++/Python)はお払い箱」みたいな
エントリをいくつか見かけたけど、まだまだそういうレベルではないと思う。</p>
<p>Goは非常に興味深い言語だし、当面いろいろと話題を提供してくれるとは思うけど、
これが定着するか、成功した言語になるかどうかは、長い目で見ないとわからないと思う。</p>
<p>GoogleやRob PikeやKen Thompsonのネームバリューのおかげで、
普通なら10年かかるプログラミング言語のブランド確立を一瞬で達成してしまった
Goだけど、成熟度としてはまだまだなので、当分はそのギャップに苦しむ(？)ことに
なるんじゃないかな。</p>
<p>そこを乗り越えて、「一人前の言語」になっていくことを期待したい。</p>
<h4>まとめ</h4>
<ul>
<li>言語の成功は長い目で見よう</li>
<li>Goガンバレ(えらそう)</li>
</ul>

</div>

<div style="text-align: center;"><script type="text/javascript"><!--
google_ad_client = "pub-1068577065829336";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_channel ="1130103482";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>
</div>

<div class="comment">

		<div class="caption">本日のツッコミ(全30件) [<a href="http://www.rubyist.net/~matz/20091113.html#c">ツッコミを入れる</a>]</div>
		<div class="commentshort">
			<p><a href="http://www.rubyist.net/~matz/20091113.html#c00">Before...</a></p>
				<p><a href="http://www.rubyist.net/~matz/20091113.html#c21"><span class="canchor">_</span></a>
				<span class="commentator">とおりすがり</span>&nbsp;[ええ、捏造は言いすぎたと反省してます。 撤回します。]</p>
				<p><a href="http://www.rubyist.net/~matz/20091113.html#c22"><span class="canchor">_</span></a>
				<span class="commentator">roverhand</span>&nbsp;[とおりすがりさんは、言いすぎかどうかという前に、勘違いしてるのではないかと思うのです。  お払い箱論調に対して「..]</p>
				<p><a href="http://www.rubyist.net/~matz/20091113.html#c23"><span class="canchor">_</span></a>
				<span class="commentator">ん</span>&nbsp;[なうってなんだよ。 にょと変わらんな。キモ。]</p>
				<p><a href="http://www.rubyist.net/~matz/20091113.html#c24"><span class="canchor">_</span></a>
				<span class="commentator">とおりすがり</span>&nbsp;[勘違いではありません。 否定的な情報を並べて達観するのはH○Kが良くやるプロパガンダの手法です。N○K自体は否定し..]</p>
				<p><a href="http://www.rubyist.net/~matz/20091113.html#c25"><span class="canchor">_</span></a>
				<span class="commentator">加藤和良</span>&nbsp;[まつもとさんが読まれたのは、ここからリンクされているスレッドではないでしょうか。 http://news.ycom..]</p>
				<p><a href="http://www.rubyist.net/~matz/20091113.html#c26"><span class="canchor">_</span></a>
				<span class="commentator">hnakamur</span>&nbsp;[加藤和良さんが紹介されたスレッドに http://code.google.com/p/unladen-swallo..]</p>
				<p><a href="http://www.rubyist.net/~matz/20091113.html#c27"><span class="canchor">_</span></a>
				<span class="commentator">まつもと ゆきひろ</span>&nbsp;[加藤和良さん、 ありがとうございます。私の記憶と一致します。 そうか、Hacker Newsか。 複数提示する..]</p>
				<p><a href="http://www.rubyist.net/~matz/20091113.html#c28"><span class="canchor">_</span></a>
				<span class="commentator">kyon</span>&nbsp;[以前、Pascalっぽくないとコメントしてしまったのですが、今はGoは、けっこうPascalっぽいと思ってます。すみ..]</p>
				<p><a href="http://www.rubyist.net/~matz/20091113.html#c29"><span class="canchor">_</span></a>
				<span class="commentator">ま。</span>&nbsp;[こんなページもありました。 Ciao Python, Hola Go! http://tav.espians.c..]</p>
				<p><a href="http://www.rubyist.net/~matz/20091113.html#c30"><span class="canchor">_</span></a>
				<span class="commentator">KL1</span>&nbsp;[Goで思い出したのですが、KL1ってどうなったんでしょうか? http://www37.atwiki.jp/pro..]</p>
		</div>
</div>



	<div class="comment trackbacks">
		<div class="caption">
			[TrackBack URL: <a href="http://www.rubyist.net/~matz/tb.rb/20091113">http://www.rubyist.net/~matz/tb.rb/20091113</a>]
		</div>
		<div class="commentshort trackbackshort">
		</div>
	</div>





		<div class="referer">
		
		</div>
</div>


	<hr class="sep">
	
<div class="day">
<h2><span class="date">
<a href="http://www.rubyist.net/~matz/20101113.html">2010-11-13</a>
</span> 
<span class="title"></span></h2>

<div class="body">

<div class="section">

<h3><a href="http://www.rubyist.net/~matz/20101113.html#p01"><span class="sanchor">_</span></a> [<a href="http://www.rubyist.net/~matz/?year=2003;month=4Q;category=Ruby">Ruby</a>] RubyConf 2010 キーノート(2)</h3>
<p><a href="http://www.rubyist.net/~matz/20101112.html#p01">前回</a>に続いて
未来(≒Ruby 2.0)の話を。</p>
<p>今回、紹介した「未来」の機能は以下の通り。</p>
<ul>
<li>Traits</li>
<li>Method Combination</li>
<li>Keyword arguments</li>
<li>Namespaces</li>
</ul>
<p>今まで話してきたことじゃん、と思うでしょうが、その通り。
違いは</p>
<ul>
<li>これらの機能が単なるアイディアではなく、どのように実装すべきかほぼ見えている</li>
<li>実装した機能を突っ込む場所(trunk)が明確になっている</li>
</ul>
<p>点です。特に後者は大きい。</p>
<h4>Traits</h4>
<p>Traitsの定義は</p>
<blockquote>
<p>a trait is a collection of methods, used as a "simple conceptual model for structuring object oriented programs".</p>
<p>from Wikipedia (en)</p>
</blockquote>

<p>ということで、モジュールとほぼ同じようなものです。
実際、今回導入するTraitsは言語要素の実体としてはモジュールを利用します。</p>
<p>ただ、モジュールの機能を取り込むのにincludeではない
別のやり方(mix)を導入することによって、includeが持ついくつかの問題を解消しよう
というものです。includeの方が便利なこともあるので、includeもなくなりません。</p>
<p>includeの問題は</p>
<ul>
<li>名前の重複を検出できないこと</li>
<li>モジュールのinclude関係が後から変化した場合の一貫性のない挙動</li>
<li>メソッドを後から修飾する(wrapする)方法が提供されない</li>
</ul>
<p>ことです。</p>
<p>擬似的な多重継承であるincludeは、
includeされたモジュールが継承ライン(ancestors)に含まれるようになります。
この時、状況によっては予測困難なことが発生します。</p>
<p>ひとつはincludeされた複数のモジュールで同名のメソッドが定義されていた場合、
その重複が意図されたもの(override)か、偶然か(conflict)か、
区別する手段がないところです(名称重複問題)。</p>
<p>もうひとつは、いくつかの状況で継承ラインに並ぶモジュールの順序が予測しがたい
(ので、メソッド名の重複時にどれが優先になるのか直感的でない)ことです。</p>
<pre>module American
  attr_accessor :address
end
module Japanese
  attr_accessor :address
end
class JapaneseAmerican
  include American
  include Japanese
end
JapaneseAmerican.new.address
# which address?
p JapaneseAmerican.ancestors
# =&gt; [JapaneseAmerican, Japanese, American, Object, Kernel]</pre>
<p>この例ではaddressという属性(メソッド)がAmericanとJapaneseの間で
重複していますが、これが意図的な重複なのか偶然かは言語にはわかりません。
継承ラインの順にしたがってメソッドを呼び出すだけです。</p>
<p>実際にはJapaneseモジュールが優先されてそのaddressメソッドが呼ばれるのですが、
ひとめでそれが分かるのは、だいぶ「訓練されたRubyist」です。</p>
<p>現在のRubyでは、includeされた時、
「スーパークラスですでにそのモジュールがincludeされていた時には
二重にincludeしない」という挙動になっています<span class="footnote"><a name="fm20101113-01-01" href="#f20101113-01-01" title="  MacRubyでは違うらしい。Ruby 1.9でそのような変更をしたかったが、YARVが継承ラインに同じモジュールが2度登場しないことを前提にしていたため断念 
">*1</a></span>。ですから、
スーパークラスでincludeされていることに気がつかなかった場合、
includeしても継承ラインのその場所にモジュールが登場しなかった
ということが起こりえます。</p>
<p>それから、モジュールが既にincludeされてから、
そのモジュールに対してincludeを行った場合、
既に存在するクラスの継承ラインには新たにincludeされるようになったモジュールは含まれません。
つまり、includeのタイミングによって継承ラインへの反映のされ方が異なるわけです。
ちょっと気持ち悪いです。</p>
<p>これらを(ある程度)解決する手段がmixメソッドです。</p>
<p>mixメソッドをincludeの代わりに使うと、</p>
<ul>
<li>現在モジュールに定義されているメソッドを
    クラス/モジュールに注入する</li>
<li>mixされたモジュールは継承ラインに登場しない</li>
<li>メソッド名の重複は例外になる</li>
<li>例外がイヤならモジュールを書き換える、
    または重複したメソッドの名称を変更する</li>
<li>定数を取り込むかどうかを指定できる。
    デフォルトは取り込まない</li>
</ul>
<p>という振舞いになります。これにより</p>
<ul>
<li>名称の重複はエラーになるので、見逃しがない</li>
<li>名称変更ができるので、明示的に解消できる</li>
<li>あくまでも「現時点での状態の注入」なので、
    継承ラインが変化した時の「おかしさ」がない。
    問題は解決していないが、気分は良い(苦笑)</li>
</ul>
<p>ということが実現できます。</p>
<p>たとえば以下のようなコードでは</p>
<pre>module American
  attr_accessor :address
end
module Japanese
  attr_accessor :address
end
class JapaneseAmerican
  mix American
  mix Japanese  # =&gt; address conflict!
end</pre>
<p>addressメソッドが重なっているからmixできません。
無事mixさせるためには名称衝突を明示的に回避します。</p>
<pre>class JapaneseAmerican
  mix American, :address =&gt; :us_address
  mix Japanese, :address =&gt; :jp_address
end</pre>
<p>これで、addressという名前による重複はなくなりました。</p>
<p>なぜ、includeにオプションをつけるのではなく、
新しいメソッドを導入して言語をより複雑にするかというと、
個人的にmixの挙動の方が望ましいと思っていて、
ユーザーをそちらに誘導するためには、より短い名前の方が望ましいと思ったからです。</p>
<p>Traitsを実現するmixメソッドの実装ですが、
RubyKaigiでこれを紹介したその日には中田さんが着手していて、
パッチは完成しているそうです。</p>
<p>ただ、各種プレゼンテーションでは説明しなかった以下の課題があり、
これらについては結論を出す必要があります。</p>
<ul>
<li>mixされるモジュールが別のモジュールをincludeしていた場合にはどうなるか。
    おそらくは例外になる。mixとincludeは混ぜるべきではない。</li>
<li>mixで別名を付けて問題解決、と読めるような言い方をしているが、
    実際にはモジュール内部で名前を書き換える前のメソッドを読んでいる可能性がある。
    それをどうするか。なにもしない(重複する方が悪い)とする考えもあるが、
    それだとせっかく苦労してTraitsを導入しようとしているのが
    まったく無駄になるので、名前を書き換えたメソッド呼び出しを
    モジュールのメソッド定義実体から探し出してメソッドをコピーする
    という(Bertrand MayerのOOSCに記述されていたアイディア)を導入することを考える</li>
<li>インスタンス変数の名称重複を解決する手段がない。
    これはサブクラスからは見えないインスタンス変数を導入し、
    mix対象のクラスではそちらを使うこと推奨とするべきではないかと
    考えています。1.9向けのパッチは既に書いてありますが、
    プライベートなインスタンス変数の記法を @_fooをにするか、@__fooにするか、
    はたまたまったく違うナニかを考えるのかが難しくて現状では放置されています。
    mixが導入されたらより必要になるでしょうね。</li>
</ul>
<h4>Method Combination</h4>
<p>RubyKaigiではmixの一部として導入する話をしていたMethod Combinationだが、
mixでいちいち「どのメソッドをラップするか」とか指定するのが以上にめんどくさいことに
後で気がつきました。ので、分離。</p>
<p>今回の案はprependというメソッドを導入すること。「include、mixに続いて
またもうひとつ？」という声が聞こえてきそうだが、私もそう思います。でも必要なのよ。</p>
<p>prependはそのモジュールが提供する機能を、現在のクラス/モジュールの「前」に
追加する機能。</p>
<pre>module Foo
  def foo
    p :before
    super
    p :after
  end
end
class Bar
  def foo
    p :foo
  end
  prepend Foo
end
Bar.new.foo # :before, :foo, :after</pre>
<p>とように使う。prependしたモジュールFooで定義されたfooメソッドが、
prepend先のメソッドfooをラップしているのが分かるでしょうか。</p>
<p>prependメソッドは、RailsコミッタでもあるYehuda Katzの提案で、
これがあればRailsのalias_method_chainを撲滅できる、と息巻いていた。
私もそう思う。</p>
<p>具体的な実装はまだないんだけど、たぶんT_ICLASSのようなものを
継承チェーンに置いて、そっちを先に検索するようにするんじゃないかなあ。</p>
<h4>Keyword Arguments</h4>
<p>引数、特にオプショナル引数がどんな働きをするのか忘れる人は私だけじゃないと思います。
たとえば、 public_instance_methods メソッドはオプショナル引数を受け付けるのだけど、
それが「オプショナル引数を付けると、それが真であった時にスーパークラスのメソッドを含む」のか、
それとも逆かというのは私でもいつも忘れてしまいます。正解はfalseを付けた時に含まない。</p>
<p>これをたとえば</p>
<pre>aClass.public_instance_methods(include_super: false)</pre>
<p>と書けたら、ずっと覚えやすくなるというものです。</p>
<p>Rubyのキーワード引数は、1.9で追加されたシンボル記法のハッシュが
引数リストの末尾に付いているだけです。</p>
<p>2.0で新たに追加されたのは、メソッド定義側でこれを簡単に受け取れる記法です。</p>
<p>例としてはこんな感じ。</p>
<p>呼び出し側</p>
<pre>1.step(by: 2, to: 20) do |i|
  p i
end</pre>
<p>呼び出され側</p>
<pre>def step(by: step, to: limit)
  ...
end</pre>
<p>後、「**」で辞書形式で受けとるとか、ちょっとした機能追加もありますが、
基本的にはこれだけ。</p>
<h4>Namespace</h4>
<p>技術的な詳細などについては同じRubyConfで前田(修吾)くんが<a href="http://www.slideshare.net/ShugoMaeda/rc2010-refinements">発表したスライド</a>を見てもらった方が良いと思います。</p>
<p>Rubyではopen classといって既存のクラスの定義を書き換えちゃうことができる。
メソッドの追加も自由自在だ。このように既存のクラスに「パッチ」を当てちゃう技法のことを
「Monkey Patching」と呼ぶことも多い。</p>
<p>これは「ゲリラ・パッチング」→「ゴリラ・パッチング」→「モンキー・パッチング」と
変化して生まれた用語なんだって。
まあ、Rubyはクラスなんてものは変化するもんじゃないって「硬い」言語よりも
大きな自由を提供してることは確かだよね。
DHHは今回のRubyConfのキーノートで「今後はMonkey PatchingじゃなくてFreedom Patchingと呼ぼう」と
叫んでた。メル・ギブソンの『ブレーヴハート』を引用しつつ。「ふりーだーーむ」。</p>
<p>まあ、フリーダムなのは素晴らしいことなんだけど、影響力が大きすぎるというのもまた事実。
やろうと思えば整数のプラスメソッドを書き換えて、1+2 = 42 のような変更だってできちゃうから。
でも、大抵のプログラムは副作用でまともに動作しなくなるよね。</p>
<p>で、問題はこのような変更の影響の範囲がグローバル(プログラム全体)であることで、
仮にこのような修正をなんらかの「スコープ」に閉じ込めることができたなら、
もっと安全に、もっと安心して「フリーダム・パッチング」を活用できる、はず。</p>
<p>そのような「スコープ」のために、昔からClassboxとかSelector Namespaceとかが提案されてきた
のですが、今回、前田くんが実装したのはSelector Namespaceの一種であるRefinment。</p>
<p>たとえば、以下のようなプログラムがあったとします。っていうか、あります。</p>
<pre>class Integer
  def /(other)
    return quo(other)
  end
end
p 1/2 # =&gt; (1/2)</pre>
<p>これは割り算演算子(/)を再定義して、整除ではなく結果を有理数にしようもので、
標準添付ライブラリの mathn の本質部分です。
しかし、整数の割り算の結果が整数であることを期待しているコードは当然存在するわけで、
そのようなコードは上のような変更で破綻する可能性があります。</p>
<p>そこで今回導入しようというのがrefinmentです(呼び名は変わるかもしれません)。
文法としては以下のようになります。</p>
<pre>module MathN
  refine Integer do
    def /(other)
      return quo(other)
    end
  end
  p 1/2 # =&gt; (1/2)
end
p 1/2   # =&gt; 0</pre>
<p>Refinementの単位としてはモジュールを使います。またモジュールです。大活躍ですね。</p>
<p>モジュールの中では既存のクラスをrefineできます。
refineの中で定義された修正はそのrefinment(ネームスペース)の中でだけ有効です。
ですから、MathNモジュールの中では 1/2 は有理数の (1/2) であり、
その外側では今まで通り整除になっています。有効範囲はレキシカルであり、
Refinmentはブロックの外側には影響を与えません。</p>
<p>Classboxとの違いは、そこを通じて呼び出された先(レキシカルスコープの外)に
「置き換え」が影響を与えるかで、いろいろ検討した結果、
多くのプログラミング言語がダイナミックスコープをあきらめたのと同様の理由で
「置き換え」はレキシカルになるべきだとの結論を出しました。</p>
<p>モジュールとして実現されたネームスペースを使うには usingメソッドを使います。
こんな感じ。</p>
<pre>module Rationalize
  using MathN
  p 1/2 # =&gt; (1/2)
end
p 1/2 # =&gt; 0</pre>
<p>これでRationalizeモジュールの中ではMathNが提供するRefinementが利用できます。</p>
<p>さらに、今までメソッドの中でメソッドをネストして定義した場合、
そのメソッドはクラスに直接定義されてあんまり意味ないじゃん、みたいな状態になっていたのですが、
今後はそのメソッドの範囲内でだけ有効なRefinementにネストの内側のメソッドが定義されるので、
完全にプライベートなメソッドとして使うことができます。</p>
<pre>class Foo
   def foo
      def bar
        ...
      end
      bar # 呼べる
   end

   def quux
     bar  # 呼べない
   end
end</pre>
<p>この変更はかなり大規模かつ複雑なものですが、前田くんのところでは実際に動作しています。
早く trunk に突っ込みたいものです。しかし、NaCl取締役の激務をこなしつつ、
こんなスーパーなパッチを作っちゃう前田くんに拍手。</p>
<h4>まとめ</h4>
<p>歴史編で見てきた通り、ずっと昔からキーワード引数などについて話してきましたが、
とうとう現実になりそうです。長かった。</p>
<div class="footnote">
	<p class="footnote"><a name="f20101113-01-01" href="#fm20101113-01-01">*1</a>&nbsp;  MacRubyでは違うらしい。Ruby 1.9でそのような変更をしたかったが、YARVが継承ラインに同じモジュールが2度登場しないことを前提にしていたため断念 
</p>
</div>

</div>

<div style="text-align: center;"><script type="text/javascript"><!--
google_ad_client = "pub-1068577065829336";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_channel ="1130103482";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>
</div>

<div class="comment">

	<div class="caption">[<a href="http://www.rubyist.net/~matz/20101113.html#c">ツッコミを入れる</a>]</div>
</div>



	<div class="comment trackbacks">
		<div class="caption">
			[TrackBack URL: <a href="http://www.rubyist.net/~matz/tb.rb/20101113">http://www.rubyist.net/~matz/tb.rb/20101113</a>]
		</div>
		<div class="commentshort trackbackshort">
		</div>
	</div>





		<div class="referer">
		
		</div>
</div>


	<hr class="sep">

<div class="adminmenu">
<span class="adminmenu"><a href="http://www.rubyist.net/~matz/1112.html">&laquo;前の日(11-12)</a></span>
<span class="adminmenu"><a href="http://www.rubyist.net/~matz/">最新</a></span>
<span class="adminmenu"><a href="http://www.rubyist.net/~matz/1114.html">次の日(11-14)&raquo;</a></span>
<span class="adminmenu"><a href="https://www.rubyist.net/~matz/update.rb" rel="nofollow">追記</a></span>
</div>
<center>
<!-- Rakuten Dynamicad FROM HERE -->
<script type="text/javascript">
<!-- 
rakuten_template = "728_90_txt";
rakuten_affiliateId = "059c6b10.b3eb768e.059c6b11.e98254f4";
rakuten_target = "_blank";
rakuten_color_bg = "FFFFFF";
rakuten_color_border = "BF0000";
rakuten_color_text = "000000";
rakuten_color_link = "0000FF";
rakuten_color_price = "CC0000";
//--></script>
<script type="text/javascript"
  src="http://dynamic.rakuten.co.jp/js/rakuten_dynamic.js">
</script>
<!-- Rakuten Dynamicad TO HERE -->
</center><br>

<a href="http://trackfeed.com/"><img name="trackfeed_banner" src="http://img.trackfeed.com/img/tfg.gif" alt="track feed" border="0" align="absmiddle" /></a>
<nobr><a href="http://trackfeed.com/u/8812bdcfc0b3f5e81039fbe7e75967d58b534a24/Matz%E3%81%AB%E3%81%A3%E3%81%8D/http%3A%2F%2Fwww.rubyist.net%2F%7Ematz%2F/ca1b4d15">Matzにっき</a></nobr>
<script type="text/javascript">
document.write(unescape("%3Cscript src='http://script.trackfeed.com/usr/f/5/0257873c.js' type='text/javascript'%3E%3C/script%3E"));
</script>

<!-- Creative Commons License -->
<a rel="license" href="http://creativecommons.org/licenses/by-nc/2.1/jp/"><img alt="Creative Commons License" border="0" src="http://creativecommons.org/images/public/somerights20.gif" /></a>
This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc/2.0/jp/">Creative Commons License</a>.
<!-- /Creative Commons License -->

<!--

<rdf:RDF xmlns="http://web.resource.org/cc/"
    xmlns:dc="http://purl.org/dc/elements/1.1/"
    xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
<Work rdf:about="">
   <dc:type rdf:resource="http://purl.org/dc/dcmitype/Text" />
   <license rdf:resource="http://creativecommons.org/licenses/by-nc/2.0/jp/" />
</Work>

<License rdf:about="http://creativecommons.org/licenses/by-nc/2.0/jp/">
   <permits rdf:resource="http://web.resource.org/cc/Reproduction" />
   <permits rdf:resource="http://web.resource.org/cc/Distribution" />
   <requires rdf:resource="http://web.resource.org/cc/Notice" />
   <requires rdf:resource="http://web.resource.org/cc/Attribution" />
   <permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" />
</License>

</rdf:RDF>

-->




<div class="footer">
Generated by <a href="http://www.tdiary.org/">tDiary</a> version 2.2.0<br>
Powered by <a href="http://www.ruby-lang.org/">Ruby</a> version 1.8.7
</div>
</body>
</html>
