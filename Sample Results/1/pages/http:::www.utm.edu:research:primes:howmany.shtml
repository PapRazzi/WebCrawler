<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
 <link rel="stylesheet" type="text/css" href="includes/primepages2.css">
 <title>How many primes are there?</title>
 <!--Owned by Chris Caldwell, all rights reserved-->
 <meta name="description" content="The prime number theorem tells us the 
      number of primes less than n is about 1/log(n).  This pages includes 
      history, theorems, related results and open questions.">
 <meta name="keywords" content="prime, primes, prime number theorem, number theory, mathematics, how many, Reimann, counting">
 <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
 <meta name="author" content="Chris K. Caldwell">
 <link rev="made" href="mailto:caldwell@utm.edu">
 <style type="text/css">
<!--
.style1 {color: #FF0000}
-->
 </style>
</head>

<body bgcolor="#FFFFFF">

<h1 align="CENTER">How Many Primes Are There?</h1>
<a name="contents"></a>
<h3>Contents:</h3>
<ol>
  <li><a href="#intro">Introduction:</a> Asking the Correct Question 
    <ul>
      <li><a href="#pi_def">pi(<i>x</i>) is the number of primes less than or 
        equal to <i>x</i></a> 
      <li><a href="#table">A Table of values of pi(<i>x</i>)</a> 
    </ul>
  <li><a href="#pnt">The Prime Number Theorem</a> 
    <ul>
      <li><a href="#1">Consequence One:</a> You can Approximate pi(<i>x</i>) with 
        <i>x</i>/(log <i>x</i> - 1) 
      <li><a href="#2">Consequence Two:</a> The <i>n</i>th prime is about <i>n</i> 
        log <i>n</i> 
      <li><a href="#3">Consequence Three:</a> The chance of a random integer <i>x</i> 
        being prime is about 1/log <i>x</i>
    </ul>
  <li><a href="#hist">History</a> of the Prime Number Theorem and other approximations 
    of pi(<i>x</i>) 
  <li><a href="#better">There are better estimates!</a>
</ol>

<!-- #BeginLibraryItem "/Library/Jump Bar (without side menu).lbi" --><p></p><hr>
<b>Primes:</b>
[ <a HREF="http://primes.utm.edu/" class=menu title="Home page"><b>Home</b></a> 
|| <a HREF="http://primes.utm.edu/largest.html" class=menu><b>Largest</b></a>
| <a HREF="http://primes.utm.edu/prove/" class=menu>Proving</a>
| <a HREF="http://primes.utm.edu/howmany.shtml" class=menu>How Many?</a>
| <a HREF="http://primes.utm.edu/mersenne/" class=menu>Mersenne</a>
| <a HREF="http://primes.utm.edu/glossary/" class=menu>Glossary</a>
| <a HREF="http://groups.yahoo.com/group/primenumbers/" class=menu>Mailing List</a> ]<br \>
<b>Translation:</b> <a href="http://softdroid.net/android-sdk-howmany">Ukrainian</a>
<hr><p></p>
<!-- #EndLibraryItem --><div align="center">
  <center>
  <table class="double" bgcolor="#F0F9FF" cellspacing="1" cellpadding="5">
    <tr>
      <td>Notes: (1) Rather than fill this document with gifs like &quot;<img src="gifs/pi_of_x.gif" alt="[pi(x) using the Greek letter pi]" width="30" height="14">&quot;
        (which can not be displayed on some browsers and display poorly on
        others), I am going to just write pi(<i>x</i>).&nbsp; (2) log <i>x</i>,
        in this document, is the natural logarithm.&nbsp; This is sometimes
        denoted ln <i>x</i>, but log <i>x</i> is the mathematical standard.</td>
    </tr>
  </table>
  </center>
</div>

<a name="intro"></a>
<h2><a href="#contents"><img src="gifs/up.gif" alt="[up]" width="28" height="28"></a>&nbsp;&nbsp;
1. Introduction: Asking the Correct Question</h2>

Over 2,300 years ago <a href="notes/proofs/infinite/">Euclid proved</a> that the
number of primes is infinite, so two possible questions come to mind:
<ol>
  <li>How many primes are there less than the number x?
  <li>There are infinitely many primes, but how big of an infinity?
</ol>
This document will focus on the first question.&nbsp; The second question is
discussed on the page &quot;<a href="infinity.shtml">How Big of an Infinity?</a>.&quot;

<a name="pi_def"></a>
<h3>1.1. pi(<i>x</i>) is the number of primes less than or equal to <i>x</i></h3>
Let <i>x</i> be a positive real number.&nbsp; The question &quot;how many
primes are there less than <i>x</i>?&quot; has been asked so frequently that its
answer has a name:
<blockquote>
  <img src="gifs/pi_of_x.gif" alt="[pi(x) using the Greek letter pi]" width="30" height="14">
  = <b>pi(<i>x</i>) = the number of primes less than or equal to <i>x</i>.</b>
</blockquote>
The primes under 25 are 2, 3, 5, 7, 11, 13, 17, 19 and 23 so pi(3) = 2, pi(10) =
4 and pi(25) = 9.&nbsp; (A longer table can be found in the <a href="#table">next
sub-section</a>.)&nbsp; Look at the following graph and notice how irregular the
graph of pi(<i>x</i>) is for small values of <i>x</i>.<center>
<p align="center"><img alt="[Graph of pi(x), 0&lt;x&lt;100]" src="gifs/pi100.gif" width="420" 
height="300"></p>
</center>Now back up and view a larger portion of the graph of pi(<i>x</i>).<center>
<p align="center"><img alt="[Graph of pi(x), 0&lt;x&lt;1000]" src="gifs/pi1000.gif" width="420" 
height="300"></p>
</center>So even though pi(<i>x</i>) is <a href="notes/gaps.html">&quot;locally&quot;
irregular</a>, there is a definite trend to its values.&nbsp; (<a href=gifs/pi1000000.gif>Graph to 
1,000,000</a>.)

<p> In this document we will study the function pi(<i>x</i>), the prime number theorem (which quantifies
this trend) and several classical approximation to pi(<i>x</i>).

<blockquote>
  <a name="table"></a>
  <table border="0" align="right" bgcolor="#F0F9FF">
    <caption><b>Table 1.&nbsp; Values of pi(<i>x</i>)</b></caption>
    <tr>
      <th bgcolor="#CCEEFF">&nbsp;</th>
      <th bgcolor="#CCEEFF">
        <p align="right"><i>x</i></p>      </th>
      <th align="right" bgcolor="#CCEEFF">pi(<i>x</i>)</th>
      <th bgcolor="#CCEEFF">reference</th>
    </tr>
    <tr>
      <td align="right">1</td>
      <td align="right">10</td>
      <td align="right">4</td>
      <td align="left">&nbsp;</td>
    </tr>
    <tr>
      <td align="right">2</td>
      <td align="right">100</td>
      <td align="right">25</td>
      <td align="left">&nbsp;</td>
    </tr>
    <tr>
      <td align="right">3</td>
      <td align="right">1,000</td>
      <td align="right">168</td>
      <td align="left">&nbsp;</td>
    </tr>
    <tr>
      <td align="right">4</td>
      <td align="right">10,000</td>
      <td align="right">1,229</td>
      <td align="left">&nbsp;</td>
    </tr>
    <tr>
      <td align="right">5</td>
      <td align="right">100,000</td>
      <td align="right">9,592</td>
      <td align="left">&nbsp;</td>
    </tr>
    <tr>
      <td align="right">6</td>
      <td align="right">1,000,000</td>
      <td align="right">78,498</td>
      <td align="left">&nbsp;</td>
    </tr>
    <tr>
      <td align="right">7</td>
      <td align="right">10,000,000</td>
      <td align="right">664,579</td>
      <td align="left">&nbsp;</td>
    </tr>
    <tr>
      <td align="right">8</td>
      <td align="right">100,000,000</td>
      <td align="right">5,761,455</td>
      <td align="left">&nbsp;</td>
    </tr>
    <tr>
      <td align="right">9</td>
      <td align="right">1,000,000,000</td>
      <td align="right">50,847,534</td>
      <td align="left">&nbsp;</td>
    </tr>
    <tr>
      <td align="right">10</td>
      <td align="right">10,000,000,000</td>
      <td align="right">455,052,511</td>
      <td align="left">&nbsp;</td>
    </tr>
    <tr>
      <td align="right">11</td>
      <td align="right">100,000,000,000</td>
      <td align="right">4,118,054,813</td>
      <td align="left">&nbsp;</td>
    </tr>
    <tr>
      <td align="right">12</td>
      <td align="right">1,000,000,000,000</td>
      <td align="right">37,607,912,018</td>
      <td align="left">&nbsp;</td>
    </tr>
    <tr>
      <td align="right">13</td>
      <td align="right">10,000,000,000,000</td>
      <td align="right">346,065,536,839</td>
      <td align="left">&nbsp;</td>
    </tr>
    <tr>
      <td align="right">14</td>
      <td align="right">100,000,000,000,000</td>
      <td align="right">3,204,941,750,802</td>
      <td align="left">[<a href="references/refs.cgi/LMO85">LMO85</a>]</td>
    </tr>
    <tr>
      <td align="right">15</td>
      <td align="right">1,000,000,000,000,000</td>
      <td align="right">29,844,570,422,669</td>
      <td align="left">[<a href="references/refs.cgi/LMO85">LMO85</a>]</td>
    </tr>
    <tr>
      <td align="right">16</td>
      <td align="right">10,000,000,000,000,000</td>
      <td align="right">279,238,341,033,925</td>
      <td align="left">[<a href="references/refs.cgi/LMO85">LMO85</a>]</td>
    </tr>
    <tr>
      <td align="right">17</td>
      <td align="right">100,000,000,000,000,000</td>
      <td align="right">2,623,557,157,654,233</td>
      <td align="left">[<a href="references/refs.cgi/DR96">DR96</a>]</td>
    </tr>
    <tr>
      <td align="right">18</td>
      <td align="right">1,000,000,000,000,000,000</td>
      <td align="right">24,739,954,287,740,860</td>
      <td align="left">[<a href="references/refs.cgi/DR96">DR96</a>]</td>
    </tr>
    <tr>
      <td align="right">19</td>
      <td align="right">10,000,000,000,000,000,000</td>
      <td align="right">234,057,667,276,344,607</td>
      <td align="left">&nbsp;</td>
    </tr>
    <tr>
      <td align="right">20</td>
      <td align="right">100,000,000,000,000,000,000</td>
      <td align="right">2,220,819,602,560,918,840</td>
      <td align="left">&nbsp;</td>
    </tr>
    <tr>
      <td align="right">21</td>
      <td align="right">1,000,000,000,000,000,000,000</td>
      <td align="right">21,127,269,486,018,731,928</td>
      <td align="left">&nbsp;</td>
    </tr>
    <tr>
      <td align="right">22</td>
      <td align="right">10,000,000,000,000,000,000,000</td>
      <td align="right">201,467,286,689,315,906,290</td>
      <td align="left">&nbsp;</td>
    </tr>
    <tr>
      <td align="right">23</td>
      <td align="right">100,000,000,000,000,000,000,000</td>
      <td align="right">1,925,320,391,606,803,968,923</td>
      <td align="left">&nbsp;</td>
    </tr>
    <tr>
      <td align="right">24</td>
      <td align="right">1,000,000,000,000,000,000,000,000</td>
      <td align="right"><span class="style1">18,435,599,767,349,200,867,866</span></td>
      <td align="left" background="notes/words.html">(<a href="notes/pi(10^24).html">note</a>)</td>
    </tr>
    <tr>
      <td bgcolor="#CCEEFF">&nbsp;</td>
      <td bgcolor="#CCEEFF">&nbsp;</td>
      <td bgcolor="#CCEEFF">&nbsp;</td>
      <td align="left" bgcolor="#CCEEFF">&nbsp;</td>
    </tr>
  </table>
</blockquote>

<h3>1.2. A Table of values of pi(<i>x</i>)</h3>

For the <i>smaller</i> values of <i>x</i> in this table (say to 10,000,000,000)
the value of pi(<i>x</i>) can be found by finding and counting all of the
primes.&nbsp;
<p>Before the age of computers many mathematicians formed tables of primes.&nbsp;
The most widely distributed was D. N. Lehmer's table of primes to 10,006,721 [<a href="references/refs.cgi/Lehmer14">Lehmer14</a>].&nbsp;
By far the most amazing was a table by Kulik completed in 1867.&nbsp; This table
listed the smallest factors of integers (hence all the primes) up to
100,330,200!</p>
<p>In the 1870's Meissel developed a clever way to calculate pi(<i>x</i>) far
beyond the known tables of primes and in 1885 (slightly mis-)calculated pi(10<sup>9</sup>).&nbsp;
Meissel's methods were simplified by D. H. Lehmer in 1959 and then in 1985
improved using sieve techniques by Lagarias, Miller and Odlyzko [<a href="references/refs.cgi/LMO85">LMO85</a>].</p>
<p>In 1994 Del&eacute;glise and Rivat [<a href="references/refs.cgi/DR96">DR96</a>]
improved the technique once again to find the values for pi(10<sup>17</sup>) and
pi(10<sup>18</sup>).&nbsp; Del&eacute;glise continued this work with an improved
algorithm to find pi(10<sup>20</sup>) and other values (see his e-mail messages
of <a href="notes/md.html">18 Apr 1996</a> and <a href="notes/md6-96.html">19
Jun 1996</a>).&nbsp; See <a href="references/refs.cgi/Riesel94">Riesel94</a> for
practical information about how these calculations are made.</p>
<p> Xavier Gourdon's distributed computing project determined pi(4*10<sup>22</sup>), 
  <a href="http://numbers.computation.free.fr/Constants/Primes/Pix/pixproject.html">but
   stopped when they found</a> an error of at least one in the calculation of
   pi(10<sup>23</sup>).&nbsp; 
  Tom&aacute;s Oliveira e Silva has <a href="http://www.ieeta.pt/%7Etos/primes.html">extensive
   tables of values</a> of pi(<i>x</i>) and pi<sub>2</sub>(<i>x</i>). In 2007
   he reevaluated pi(10<sup>23</sup>) to get the value in
   the table.&nbsp; This calculation was done on a single machine and 
verified in 2008. </p>
<p>The value given in red for pi(10<sup>24</sup>) was found by an analytic methods assuming the 
unproven 
Riemann Hypothesis by J. Buethe, J. Franke, A. Jost, T. Kleinjung. Their method &quot;is similar to the one described by Lagarias and  Odlyzko, but uses the Weil explicit formula instead of  complex curve integrals&quot; (see their <a href="notes/pi(10^24).html">e-mail announcing the result</a> in July 2010).</p>
<hr>

<a name="pnt"></a>
<h2><a href="#contents"><img src="gifs/up.gif" alt="[up]" width="28" height="28"></a>&nbsp;&nbsp;
2. The Prime Number Theorem: approximating pi(<i>x</i>)</h2>
Even though the distribution of primes seems random (there are (probably)
infinitely many twin primes and there are (definitely) arbitrarily large gaps
between primes), the function pi(<i>x</i>) is surprisingly well behaved: In
fact, it has been proved (see the <a href="#hist">next section</a>) that:
<blockquote>
  <b>The Prime Number Theorem:</b> The number of primes not exceeding <i>x</i>
  is <strong>asymptotic</strong> to <i>x</i>/log <i>x</i>.
</blockquote>
In terms of pi(<i>x</i>) we would write:
<blockquote>
  <b>The Prime Number Theorem:</b> pi(<i>x</i>) ~ <i>x</i>/log <i>x</i>.
</blockquote>
This means (roughly) that <i>x</i>/log <i>x</i> is a good approximation for pi(<i>x</i>)--but
before we consider this and other consequences lets be a little more specific:
<blockquote>
  &quot;<i>a</i>(<i>x</i>) is <b>asymptotic</b> to <i>b</i>(<i>x</i>)&quot; and
  &quot;<i>a</i>(<i>x</i>) <b>~</b> <i>b</i>(<i>x</i>)&quot; both mean that the
  limit (as <i>x</i> approaches infinity) of the ratio <i>a</i>(<i>x</i>)/b(<i>x</i>)
  is 1.
</blockquote>
If you have not had calculus then this means that you can make <i>a</i>(<i>x</i>)/<i>b</i>(<i>x</i>)
as close to 1 as you want by just requiring that <i>x</i> is large enough.&nbsp;
Warning: <i>a(<i>x</i>)</i>&nbsp;~&nbsp;<i>b(<i>x</i>)</i> does <i>not</i> mean
that <i>a</i>(<i>x</i>)-<i>b</i>(<i>x</i>) is small!&nbsp; For example, <i>x</i><sup>2</sup>
is asymptotic to <i>x</i><sup>2</sup>-<i>x</i>, but the difference between them,
<i>x</i>, gets arbitrarily large as <i>x</i> goes to infinity.
<h3><a name="1">Consequence One: You can Approximate pi(<i>x</i>) with <i>x</i>/(log
<i>x</i> - 1)</a></h3>
<table bgcolor="#F0F9FF" align="right">
  <caption><b>Table 2.&nbsp; pi(<i>x</i>) verse <i>x</i>/log <i>x</i></b></caption>
  <tr>
    <th bgcolor="#CCEEFF" align="right"><i>x</i></th>
    <th bgcolor="#CCEEFF" align="right">pi(<i>x</i>)</th>
    <th bgcolor="#CCEEFF" align="right"><i>x</i>/log <i>x</i></th>
    <th bgcolor="#CCEEFF" align="right"><i>x</i>/(log <i>x</i> -1)</th>
  </tr>
  <tr>
    <td align="right">1000</td>
    <td align="right">168</td>
    <td align="right">145</td>
    <td align="right">169</td>
  </tr>
  <tr>
    <td align="right">10000</td>
    <td align="right">1229</td>
    <td align="right">1086</td>
    <td align="right">1218</td>
  </tr>
  <tr>
    <td align="right">100000</td>
    <td align="right">9592</td>
    <td align="right">8686</td>
    <td align="right">9512</td>
  </tr>
  <tr>
    <td align="right">1000000</td>
    <td align="right">78498</td>
    <td align="right">72382</td>
    <td align="right">78030</td>
  </tr>
  <tr>
    <td align="right">10000000</td>
    <td align="right">664579</td>
    <td align="right">620420</td>
    <td align="right">661459</td>
  </tr>
  <tr>
    <td align="right">100000000</td>
    <td align="right">5761455</td>
    <td align="right">5428681</td>
    <td align="right">5740304</td>
  </tr>
</table>
The prime number theorem clearly implies that you can use <i>x</i>/(log <i>x</i>
- <i>a</i>) (with any constant <i>a</i>) to approximate pi(<i>x</i>).&nbsp; The
prime number theorem was stated with <i>a</i>=0, but <a href="#better">it has
been shown</a> that <i>a</i>=1 is the best choice:
<p>There are longer tables <a href="#table3">below</a> and (of pi(x) only) <a href="#table">above</a>.</p>
<blockquote>
  <b>Example:</b> Someone recently e-mailed me and asked for a list of <i>all</i>
  the primes with at most 300 digits.&nbsp; Since the prime number theorem
  implies this list would have about 1.4*10<sup>297</sup> entries we know that
  there can be no such list!
</blockquote>
Note that Pierre Dusart [<a href="references/refs.cgi/Dusart99">Dusart99</a>]
showed that if <i>x</i>&gt;598 then
<blockquote> (<i>x</i>/log <i>x</i>)(1 + 0.992/log <i>x</i>) <u>&lt;</u> pi(<i>x</i>) 
  <u>&lt;</u>(<i>x</i>/log <i>x</i>)(1 + 1.2762/log <i>x</i>) </blockquote>
(The upper bound holds for all <i>x</i> &gt; 1.)&nbsp; This gives a tight bound
for larger <i>x</i>. Note <i>x</i>/log <i>x</i><u>&lt;</u> pi(<i>x</i>) for <i>x</i>
&gt; 10.
<h3><a name="2">Consequence Two: The <i>n</i>th prime is about <i>n</i> log <i>n</i></a></h3>
Let p(<i>n</i>) be the <i>n</i>th prime.&nbsp; It is easy to show that the prime
number theorem is equivalent to the statement
<blockquote>
  <b>Theorem:</b> p(<i>n</i>) ~ <i>n</i> log <i>n</i>
</blockquote>
[see <a href="references/refs.cgi/HW79">Hardy and Wright</a>, page 10].&nbsp;&nbsp;A
better estimate is
<blockquote>
  <b>Theorem:</b> p(<i>n</i>) ~ <i>n </i>(log <i>n</i> + log log <i>n</i> - 1)
</blockquote>
[see <a href="references/refs.cgi/Ribenboim95">Ribenboim95</a>, pg. 249].
<blockquote>
  <b>Example:</b> These formulae predict that the one millionth prime is about
  13,800,000 and 15,400,000 respectively.&nbsp; In fact, the one millionth prime
  is 15,485,863.
</blockquote>
There have been many improvements on these bounds; for example, Robin [<a href="references/refs.cgi/Robin83">Robin83</a>]
showed that if <i>n</i>&gt;8601 [actually Robin erroneously used 7021], then
<blockquote>
  <i>n </i>(log <i>n</i> + log log <i>n</i> - 1.0073) &lt; p(<i>n</i>) &lt; <i>n
  </i>(log <i>n</i> + log log <i>n</i> - 0.9385)
</blockquote>
More recently Massias and Robin [<a href="references/refs.cgi/MR96">MR96</a>]
showed that if <i>n</i> <u>&gt;</u> 15985, then
<blockquote>
  p(<i>n</i>) <u>&lt;</u> <i>n</i> (log <i>n</i> + log log <i>n</i> - 0.9427)
</blockquote>
and if <i>n</i> <u>&gt;</u> 13, then
<blockquote>
  p(<i>n</i>) <u>&lt;</u> <i>n</i> (log <i>n</i> + log log <i>n</i> - 1 + 1.8
  log log <i>n</i> / log <i>n</i>)
</blockquote>
(which is better for large <i>n</i>). Pierre Dusart [<a href="references/refs.cgi/Dusart99">Dusart99</a>]
made these results stronger and showed
<blockquote>
  p(<i>n</i>) &gt; <i>n</i> (log <i>n</i> + log log <i>n</i> - 1)
</blockquote>
for all <i>n</i>.&nbsp; Dusart's article also gives better bounds getting even 
closer to the next term in the following well known asymptotic expansion for <i>p<sub>n</sub></i>.&nbsp; 
The first terms of this asymptotic expansion were given by Cipolla [<a
href="references/refs.cgi/Cipolla1902">Cipolla1902</a>] in 1902: 
<blockquote> p(<i>n</i>) = <i>n</i> (log <i>n</i> + log log <i>n</i> - 1 + (log 
  log (<i>n</i>) - 2)/log <i>n</i> -<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  ((log log (<i>n</i>))<sup>2</sup> - 6 log log (<i>n</i>) + 11)/(2 log<sup>2</sup>
  <i>n</i>) + O((log log <i>n</i> / log <i>n</i>)<sup>3</sup>))
</blockquote>
<p>Again <a href="references/refs.cgi/Ribenboim95">Ribenboim95</a> and <a href="references/refs.cgi/Riesel94">Riesel94</a>
are excellent starting places to look up more information. By the way, if you
are interested in the <i>n</i>th prime for small <i>n</i> (say less than
1,000,000,000), then use <a href="http://primes.utm.edu/nthprime/">the
<i>n</i>th prime page</a>.&quot;
<h3><a name="3">Consequence Three: The chance of a random integer <i>x</i> being 
  prime is about 1/log <i>x</i></a></h3>
Let <i>x</i> be a positive integer. Since about <i>x</i>/log <i>x</i> of the <i>x</i>
positive integers less than or equal to <i>x</i> are prime, the probability of
one of them being prime is about 1/log <i>x</i>.
<blockquote>
  <b>Example:</b> Suppose I want to find a 1000 digit prime.&nbsp; If I am
  choosing 1000 digit integers <i>x</i> to <a href="prove/">test for primality</a>
  <i>at random</i>, then I'd expect to test about log(10<sup>1000</sup>) of
  them, or about 2302 integers before finding a prime.&nbsp; Obviously if I used
  odd integers I could multiply this estimate by 1/2, and if I choose integers
  not divisible by 3, then I could multiply by 2/3,...
</blockquote>
<p>Another way to say this is that the density of primes less than <em>x</em> is 
  about 1/log <i>x</i>.&nbsp; Below is a graph of the actual density for small 
  values of <em>x</em>.
<p align=center><img src="gifs/density.gif" alt="The density of the primes from 0 to 200" width="640" height="300"></p>


<a name="hist"></a>
<h2><a href="#contents"><img src="gifs/up.gif" alt="[up]" width="28" height="28"></a>&nbsp;&nbsp; 
  3. History of the Prime Number Theorem</h2>
In 1798 Legendre published the first significant conjecture on the size of pi(<i>x</i>),
when in his book <i>Essai sur la Th&eacute;ie des Nombres</i> he stated
<blockquote>
  <dl>
    <dt>Legendre:
    <dd>pi(<i>x</i>) is approximately <i>x</i>/(log <i>x</i> - 1.08366)
  </dl>
</blockquote>
Clearly Legendre's conjecture is equivalent to the prime number theorem, the
constant 1.08366 was based on his limited table for values of pi(<i>x</i>)
(which only went to <i>x</i> = 400,000).&nbsp; In the long run 1 is <a href="#better">a
better choice</a> than Legendre's 1.08366.
<p>Gauss was also studying prime tables and came up with a different estimate
(perhaps first considered in 1791), communicated in a letter to Encke in 1849
and first published in 1863.
<blockquote>
  <dl>
    <dt>Gauss:
    <dd>pi(<i>x</i>) is approximately Li(<i>x</i>) (the principal value of
      integral of 1/log <i>u</i> from <i>u</i>=0 to <i>u</i>=<i>x</i>).
  </dl>
</blockquote>
Notice again that Gauss' conjecture is equivalent to the prime number theorem.&nbsp;
Let's compare these estimates:
<blockquote>
  <a name="table3"></a>
  <table cellpadding="3" bgcolor="#F0F9FF">
    <caption><b>Table 3. Comparisons of approximations to pi(x)</b></caption>
    <tr align="right">
      <th bgcolor="#CCEEFF" align="right"><i>x</i></th>
      <th bgcolor="#CCEEFF" align="right">pi(<i>x</i>)</th>
      <th bgcolor="#CCEEFF" align="right">Gauss' Li</th>
      <th bgcolor="#CCEEFF" align="right">Legendre</th>
      <th bgcolor="#CCEEFF" align="right"><i>x</i>/(log <i>x</i> - 1)</th>
      <th bgcolor="#CCEEFF" align="right">R(<i>x</i>)</th>
    </tr>
    <tr align="right">
      <td>1000</td>
      <td>168</td>
      <td>178</td>
      <td>172</td>
      <td>169</td>
      <td>168.4</td>
    </tr>
    <tr align="right">
      <td>10000</td>
      <td>1229</td>
      <td>1246</td>
      <td>1231</td>
      <td>1218</td>
      <td>1226.9</td>
    </tr>
    <tr align="right">
      <td>100000</td>
      <td>9592</td>
      <td>9630</td>
      <td>9588</td>
      <td>9512</td>
      <td>9587.4</td>
    </tr>
    <tr align="right">
      <td>1000000</td>
      <td>78498</td>
      <td>78628</td>
      <td>78534</td>
      <td>78030</td>
      <td>78527.4</td>
    </tr>
    <tr align="right">
      <td>10000000</td>
      <td>664579</td>
      <td>664918</td>
      <td>665138</td>
      <td>661459</td>
      <td>664667.4</td>
    </tr>
    <tr align="right">
      <td>100000000</td>
      <td>5761455</td>
      <td>5762209</td>
      <td>5769341</td>
      <td>5740304</td>
      <td>5761551.9</td>
    </tr>
    <tr align="right">
      <td>1000000000</td>
      <td>50847534</td>
      <td>50849235</td>
      <td>50917519</td>
      <td>50701542</td>
      <td>50847455.4</td>
    </tr>
    <tr align="right">
      <td>10000000000</td>
      <td>455052511</td>
      <td>455055614</td>
      <td>455743004</td>
      <td>454011971</td>
      <td>455050683.3</td>
    </tr>
  </table>
</blockquote>
In this table Gauss' Li(<i>x</i>) is always larger than pi(<i>x</i>), this is
true for all small <i>x</i> <u>&gt;</u> 2.&nbsp; However in 1914 Littlewood
proved that pi(<i>x</i>)-Li(<i>x</i>) assumes both positive and negative values
infinitely often.&nbsp; In 1986 Te Riele showed there are more than 10<sup>180</sup>
successive integers <i>x</i> for which pi(<i>x</i>)&gt;Li(<i>x</i>) between 6.62<sup>.</sup>10<sup>370</sup>
and 6.69<sup>.</sup>10<sup>370</sup>.
<p>Tchebycheff made the first real progress toward a proof of the prime number
theorem in 1850, showing there exist positive constants <i>a</i> <u>&lt;</u> 1 <u>&lt;</u>
<i>b</i> such that
<blockquote>
  <i>a</i>(<i>x</i>/log <i>x</i>) &lt; pi(<i>x</i>) &lt; <i>b</i>(<i>x</i>/log <i>x</i>)
</blockquote>
and that <strong>if</strong> pi(<i>x</i>)/(x/log x) had a limit, then its value
must be one.&nbsp; Sylvester in 1982 refined Tchebycheff's method and showed
that we can use <i>a</i> = 0.95695 and <i>b</i> = 1.04423 if <i>x</i> is large
enough.&nbsp; (In 1962 it was shown that we can use <i>a</i> = 1 for all <i>x</i>
&gt; 10 [<a href="references/refs.cgi/RS62">RS62</a>].)
<p>Finally, in 1896 Hadamard and independently de la Vall&eacute;e Poussin <b>completely
proved the prime number theorem</b> using Riemann's work relating pi(<i>x</i>)
to the complex zeta function.&nbsp; <a name="better"></a>de la Vall&eacute;e Poussin also proved
that Gauss' Li(<i>x</i>) is a better approximation to pi(<i>x</i>) than x/(log <i>x</i>
-<i>a</i>) no matter what value is assigned to the constant <i>a</i> (and also
that the best value for <i>a</i> is 1).&nbsp; A much better approximation
than any of these is the Riemann function [<a href="references/refs.cgi/Ribenboim91">Ribenboim91</a>,
<a href="references/refs.cgi/Riesel94">Riesel94</a>].
<p>In 1949 Atle Selberg [<a href="references/refs.cgi/Selberg49">Selberg49</a>]
and Paul Erd&ouml;s [<a href="references/refs.cgi/Erdos49">Erd&ouml;s49</a>]
independently gave the first elementary proofs of the prime number theorem--
here elementary means not using modern complex analysis--in fact their proofs
are very difficult!&nbsp; An easier to read (but less elementary) proof is in
Hardy and Wright's text [<a href="references/refs.cgi/HW79">HW79</a> sect.
22.15-16].
<p>Finally, when Hadamard and de la Vall&eacute;e Poussin proved the <a href="#pnt">Prime
number theorem</a>, they actually showed
<p align="center">
<img src="gifs/pnt_2.gif" 
  alt="pi(x) = Li(x) + O(x*e^(-a*sqrt(log x)))" width="205" height="34">
</p>

for some positive constant <i>a</i>.&nbsp; The error term depended on what was
known about the zero-free region of the Riemann zeta function within the
critical strip.&nbsp; As our knowledge of the size of this region increases, the
error term decreases.&nbsp; In 1901 von Koch showed that the <a href="notes/rh.html">Riemann
hypothesis</a> is equivalent to the far tighter estimate:
<p align="center">
<img src="gifs/pnt_1.gif" alt="pi(x) = Li(x) + O(x^(1/2)log x)" width="197" height="28">
</p>


<a name="better"></a>
<h2><a href="#contents"><img src="gifs/up.gif" alt="[up]" width="28" height="28"></a>&nbsp;&nbsp; 4.
  More Accurate Estimates
</h2>
<img src="gifs/pi(x)R(x).gif" alt="Graph showing R(x) approximates pi(x) well" align=right>
<p>This page focused on the prime number theorem in it simplest form, but there
  are far better estimates for pi(<i>x</i>).&nbsp; To cut to the chase, the Riemann zeta function provides a way to give an exact formula 
for pi(<i>x</i>) by summing over the non-trivial zeros of the zeta function (in order of increasing magnitude).
<blockquote>
  <img src="gifs/exact.gif" alt="An exact formula for pi(x)">
</blockquote>
(At the primes, the graph of pi(<i>x</i>) takes a step up one unit, this formula approches the value in the middle of that 
step.)&nbsp;
The first (and dominant) term above is called Riemann's function R(<i>x</i>).
<blockquote>
  <img src="gifs/R(x)def.gif" alt="The definition of R(x)">
</blockquote>
The last form above for R(<i>x</i>) is the Graham series and is an excellent way to calculate this function.&nbsp;   
The graph on the right shows how close of an approximaton R(<i>x</i>) 
is, even for small values of <i>x</i>.&nbsp;
An even better one for small <i>x</i> is the following (they are essentially the same for large <i>x</i>). 
<blockquote>
  <img src="gifs/R(x)appx.gif" alt="An approximation to \pi(x) by R(x)">
</blockquote>
To appreciate how close of an approximation these are, see the 
<a href="http://www.primefan.ru/stuff/primes/table.html">impressive tables of deviations</a>
by Andrey Kulsha.</p>

<p>Matthew R. Watkins also has a <a 
href="http://www.secamlocal.ex.ac.uk/people/staff/mrwatkin/zeta/encoding1.htm">beautiful 
development</a> of this information and some excellent animations.</p>
<!-- #BeginLibraryItem "/Library/signature (without side bar).lbi" --><p></p><hr> 
  <a href="http://primes.utm.edu/" class=menu> <img src="gifs/logo2.gif" border="0"
     ALT="Prime Pages' Home" height="20" width="90" align="left"></a> Another 
  <a HREF="http://primes.utm.edu/">prime page</a> by <a HREF="http://www.utm.edu/~caldwell">Chris 
K. Caldwell</a> &lt;<i>caldwell@utm.edu</i>&gt;<!-- #EndLibraryItem -->
</body>

</html>
