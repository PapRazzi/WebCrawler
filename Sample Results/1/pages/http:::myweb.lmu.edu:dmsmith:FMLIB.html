<html>

<HEAD>
<TITLE>
Fortran Software for Multiple Precision Arithmetic
</TITLE>

<body>

<H1 align=center>
Multiple Precision Computation
</H1>
</HEAD>

<font size=3>
<b>Dr. David M. Smith</b><br>
Professor of Mathematics (Emeritus)<br>
Loyola Marymount University<br>
Los Angeles,  CA  <br>
<b>
</b>
<!---------------------------------------------------------------------------->
<HR>

<font size=3>

<img src="email2.jpg">
<b>
</b>

<!---------------------------------------------------------------------------->
<HR>

<p>
<b>    News:
</b><p>

<b>
</b><p>




<b>   January, 2013: </b>
      

      


<table cellpadding=1 cellspacing=5 width="800" border=0>

    <tr bgcolor=white>
        <td width="70">                                                                             </td>
        <td width="730">  A few minor changes have been made to FM.f95.   &nbsp;</td>
    </tr>

    <tr bgcolor=white>
        <td width="70">                                                                             </td>
        <td width="730">  Some unused variables have been removed, and some new code for     &nbsp; </td>
    </tr>

    <tr bgcolor=white>
        <td width="70">                                                                             </td>
        <td width="730">  exception-handling in the complex arithmetic versions of exp, sin, &nbsp; </td>
    </tr>

    <tr bgcolor=white>
        <td width="70">                                                                             </td>
        <td width="730">  cos, sinh, and cosh can now return overflowed results where the   &nbsp; </td>
    </tr>

    <tr bgcolor=white>
        <td width="70">                                                                             </td>
        <td width="730">  previous version gave unknown. &nbsp; </td>
    </tr>

</table>

<b>
</b><p>




<b>   July, 2011: </b>
      

      


<table cellpadding=1 cellspacing=5 width="800" border=0>

    <tr bgcolor=white>
        <td width="70">                                                                             </td>
        <td width="730">  Some new routines and programs for multiple-precision integration   &nbsp;</td>
    </tr>

    <tr bgcolor=white>
        <td width="70">                                                                             </td>
        <td width="730">  have been added to the sample program page.     &nbsp;                    </td>
    </tr>

</table>

<b>
</b><p>




<b>   May, 2011: </b>
      

      


<table cellpadding=1 cellspacing=5 width="800" border=0>

    <tr bgcolor=white>
        <td width="70">                                                                             </td>
        <td width="730">  Version 1.3b of the FM package (April, 2011) is now available here. &nbsp;</td>
    </tr>

    <tr bgcolor=white>
        <td width="70">                                                                             </td>
        <td width="730">  This is a minor update of version 1.3 as described in the 
                          TOMS 2011 paper.      &nbsp;                                              </td>
    </tr>

    <tr bgcolor=white>
        <td width="70">                                                                             </td>
        <td width="730"> <b>    New features in this version:    </b>  &nbsp;                       </td>
    </tr>

    <tr bgcolor=white>
        <td width="70">                                                                             </td>
        <td width="730">  Many of the elementary and special functions are faster than the
                          versions in 1.2 or 1.3.     &nbsp;                                        </td>
    </tr>

    <tr bgcolor=white>
        <td width="70">                                                                             </td>
        <td width="730">        New Fortran-08 functions have been added:        &nbsp;             </td>
    </tr>

</table>

<table cellpadding=1 cellspacing=5 width="800" border=0>

    <tr bgcolor=white>
        <td width="101">                                                                            </td>
        <td width="699">  acosh(x), asinh(x), atanh(x)  --  real and complex      &nbsp;            </td>
    </tr>

    <tr bgcolor=white>
        <td width="101">                                                                            </td>
        <td width="699">  bessel_j0(x), bessel_j1(x), bessel_jn(n,x) -- standard names for 
                          existing functions      &nbsp;                                            </td>
    </tr>

    <tr bgcolor=white>
        <td width="101">                                                                            </td>
        <td width="699">  bessel_y0(x), bessel_y1(x), bessel_yn(n,x)      &nbsp;                    </td>
    </tr>

    <tr bgcolor=white>
        <td width="101">                                                                            </td>
        <td width="699">  bessel_jn(n1,n2,x),  bessel_yn(n1,n2,x)      &nbsp;                       </td>
    </tr>

    <tr bgcolor=white>
        <td width="101">                                                                            </td>
        <td width="699">  erfc_scaled(x)      &nbsp;                                                </td>
    </tr>

    <tr bgcolor=white>
        <td width="101">                                                                            </td>
        <td width="699">  atan(x,y)  --  name for atan2(x,y)      &nbsp;                            </td>
    </tr>

    <tr bgcolor=white>
        <td width="101">                                                                            </td>
        <td width="699">  hypot(x,y)  --  for sqrt( x^2 + y^2 )      &nbsp;                         </td>
    </tr>

    <tr bgcolor=white>
        <td width="101">                                                                            </td>
        <td width="699">  norm2(a)  --  for sqrt( a(1)^2 + a(2)^2 + ... + a(n)^2 )      &nbsp;      </td>
    </tr>

</table>

  


<b>
</b><p>

<b>   February, 2011: </b>
      
      

      


<table cellpadding=1 cellspacing=5 width="800" border=0>

    <tr bgcolor=white>
        <td width="70">                                                                             </td>
        <td width="730">  This is a major revision of the FM package.      &nbsp;                   </td>
    </tr>

    <tr bgcolor=white>
        <td width="70">                                                                             </td>
        <td width="730">  The code on the ACM web site is version 1.3 of FM (June, 2010).   &nbsp;  </td>
    </tr>

    <tr bgcolor=white>
        <td width="70">                                                                             </td>
        <td width="730">  This version of the FM package is described in a paper appearing in &nbsp;</td>
    </tr>

    <tr bgcolor=white>
        <td width="70">                                                                             </td>
        <td width="730">  Transactions on Mathematical Software 37 (February, 2011) 1 -- 18.  &nbsp;</td>
    </tr>

    <tr bgcolor=white>
        <td width="70">                                                                             </td>
        <td width="730"> <b>    New functions in this version:    </b>  &nbsp;                      </td>
    </tr>

</table>


<table cellpadding=1 cellspacing=5 width="800" border=0>

    <tr bgcolor=white>
        <td width="101">                                                                            </td>
        <td width="699">  bessel_j(n,x), bessel_y(n,x)      &nbsp;                                  </td>
    </tr>

    <tr bgcolor=white>
        <td width="101">                                                                            </td>
        <td width="699">  cos_integral(x), sin_integral(x)      &nbsp;                              </td>
    </tr>

    <tr bgcolor=white>
        <td width="101">                                                                            </td>
        <td width="699">  cosh_integral(x), sinh_integral(x)      &nbsp;                            </td>
    </tr>

    <tr bgcolor=white>
        <td width="101">                                                                            </td>
        <td width="699">  erf(x), erfc(x), log_erfc(x)      &nbsp;                                  </td>
    </tr>

    <tr bgcolor=white>
        <td width="101">                                                                            </td>
        <td width="699">  exp_integral_ei(x), exp_integral_en(n,x)      &nbsp;                      </td>
    </tr>

    <tr bgcolor=white>
        <td width="101">                                                                            </td>
        <td width="699">  fresnel_c(x), fresnel_s(x)      &nbsp;                                    </td>
    </tr>

    <tr bgcolor=white>
        <td width="101">                                                                            </td>
        <td width="699">  log_integral(x)      &nbsp;                                               </td>
    </tr>

</table>





<table cellpadding=1 cellspacing=5 width="800" border=0>

    <tr bgcolor=white>
        <td width="70">                                                                             </td>
        <td width="730"> <b>    New features in this version:    </b>  &nbsp;                       </td>
    </tr>

</table>




<table cellpadding=1 cellspacing=5 width="800" border=0>

    <tr bgcolor=white>
        <td width="101">                                                                            </td>
        <td width="699">  Array syntax for the three multiple precision derived types.   &nbsp;     </td>
    </tr>

    <tr bgcolor=white>
        <td width="101">                                                                            </td>
        <td width="699">  Support for much higher precision.      &nbsp;                            </td>
    </tr>

    <tr bgcolor=white>
        <td width="101">                                                                            </td>
        <td width="699">  Perfect rounding is now default.      &nbsp;                              </td>
    </tr>

    <tr bgcolor=white>
        <td width="101">                                                                            </td>
        <td width="699">  Use of undefined multiple-precision variables is detected.      &nbsp;    </td>
    </tr>

</table>



<!---------------------------------------------------------------------------->
<HR>
<b>
</b><p>

<b>   Overview of the FM package </b>                                                               <p>

The package performs multiple-precision real, complex, and integer arithmetic.                      <br>
It provides the intrinsic Fortran numerical functions, as well as many special functions that are   <br>
not included in the Fortran standard.                                                               <p>

One of the primary uses of the package is to study the accuracy and stability of numerical          <br>
algorithms by comparing results computed with several different levels of precision.                <p>

An existing Fortran program can be checked by converting it from double precision                   <br>
to FM arithmetic.  The package is designed to make this conversion fairly easy.                     <p>


The precision, base, and rounding mode for the arithmetic can be set by the user.                   <p>

Functions are available for conversion between multiple-precision numbers and machine-precision     <br>
numbers (single and double precision real and complex, and integer types).  Mixed-mode operations   <br>
involving multiple-precision numbers and machine-precision numbers are handled automatically in     <br>
statements such as a = b - 1 or y = x/3.                                                            <p>
      
There are functions for input/output operations and output formatting.  Formatting functions are    <br>
very similar to Fortran's format specifications.                                                    <p>

The package also has routines for integer multiple-precision arithmetic and functions, including    <br>
GCD, modular products and powers, and a random number generator based on 49-digit primes.           <p>

Array syntax works like Fortran's array operations in statements like v = 1, a = b + c, and         <br>
y = cos(x) when these variables are vectors or matrices of multiple precision numbers.              <p>

The program SampleFM.f95 below shows several examples of using FM for high-precision real,          <br>
complex, and integer calculations.                                                                  <p>

<b>
</b><p>

<!---------------------------------------------------------------------------->
<HR>




<h2>List of files for FMLIB 1.3: (1-7-2013 version)</h2>                                            <p>


Click a given file.  If you directly download it, there may be an extra ".txt" filetype at the      <br>
end of the file name.  Delete it.  (You might also have to change "f95" to "f90" or something       <br>
else, depending on your compiler.)                                                                  <p>

<b>     </b><p>

<a href="FM1.3/FM.f95.txt">FM.f95</a>                                                               <br>
    Subroutine library for multiple-precision operations.  63,326 lines of code                     <p>

<a href="FM1.3/FMZM90.f95.txt">FMZM90.f95</a>                                                       <br>
    Module for derived type interfaces.  47,541 lines of code                                       <p>

<a href="FM1.3/FMSAVE.f95.txt">FMSAVE.f95</a>                                                       <br>
    Module for FM internal global variables.  505 lines of code                                     <p>

<a href="FM1.3/TestFM.f95.txt">TestFM.f95</a>                                                       <br>
    Test program that checks a few operations for all of the FM routines.  43,792 lines of code     <p>

<a href="FM1.3/SampleFM.f95.txt">SampleFM.f95</a>                                                   <br>
    Small sample program using FM.  892 lines of code                                               <p>

<a href="FM1.3/SampleFM.chk.txt">SampleFM.chk</a>                                                   <br>
    Expected output file from SampleFM.f95.  157 lines                                              <p>

<a href="FM1.3/FM_User_Manual.txt">FM_User_Manual.txt</a>                                           <br>
   User's Guide for the package, along with a list of the files, some troubleshooting advice,       <br>
   and an example set of compiler/linker commands for building the programs.  2,354 lines           <p>




<!---------------------------------------------------------------------------->
<HR>


<h2>Papers Online (in pdf format)</h2><p>

    All of these are technical papers explaining the algorithms used by the multiple-precision      <br>
    package, except the last one.                                                                   <p>

    "Using Multiple-Precision Arithmetic" gives some samples and discusses the package              <br>
    from a user's point of view.                                                                    <p>

<a href="MComp1989.pdf">
   Efficient Multiple-Precision Evaluation of Elementary Functions</a>                              <br>
   Mathematics of Computation 52 (1989) 131 -- 134                                                  <p>

<a href="toms1991.pdf">
   A Fortran Package For Floating-Point Multiple-Precision Arithmetic</a>                           <br>
   Transactions on Mathematical Software 17 (1991) 273 -- 283                                       <p>

<a href="MComp1996.pdf">
   A Multiple-Precision Division Algorithm</a>                                                      <br>
   Mathematics of Computation 66 (1996) 157 -- 163                                                  <p>

<a href="toms1998.pdf">
   Multiple Precision Complex Arithmetic and Functions</a>                                          <br>
   Transactions on Mathematical Software 24 (1998) 359 -- 367                                       <p>

<a href="toms2001.pdf"> 
   Multiple-Precision Gamma Function and Related Functions</a>                                      <br>
   Transactions on Mathematical Software 27 (2001) 377 -- 387                                       <p>

<a href="toms2011.pdf"> 
   Multiple-Precision Exponential Integral and Related Functions</a>                                <br>
   Transactions on Mathematical Software 37 (2011) 1 -- 18                                          <p>

<a href="CSE2003.pdf"> 
   Using Multiple-Precision Arithmetic</a>                                                          <br>
   Computing in Science and Engineering 5 (July, 2003) 88 -- 93                                     <p>

<!---------------------------------------------------------------------------->
<HR>


<h2>Papers Online (individual pages can be viewed with a browser)</h2><p>

<b>    Efficient Multiple-Precision Evaluation of Elementary Functions </b>                         <br>
    Mathematics of Computation 52 (1989) 131 -- 134                                                 <br>
Page  <a href="MComp1989p1.html">1</a>, 
      <a href="MComp1989p2.html">2</a>, 
      <a href="MComp1989p3.html">3</a>, 
      <a href="MComp1989p4.html">4</a>                                                              <p>

<b>    A Fortran Package For Floating-Point Multiple-Precision Arithmetic </b>                      <br>
    Transactions on Mathematical Software 17 (1991) 273 -- 283                                      <br>
Page  <a href="toms1991p01.html">1</a>, 
      <a href="toms1991p02.html">2</a>, 
      <a href="toms1991p03.html">3</a>, 
      <a href="toms1991p04.html">4</a>, 
      <a href="toms1991p05.html">5</a>, 
      <a href="toms1991p06.html">6</a>, 
      <a href="toms1991p07.html">7</a>, 
      <a href="toms1991p08.html">8</a>, 
      <a href="toms1991p09.html">9</a>, 
      <a href="toms1991p10.html">10</a>                                                             <p>

<b>    A Multiple-Precision Division Algorithm </b><br>
    Mathematics of Computation 66 (1996) 157 -- 163                                                 <br>
Page  <a href="MComp1996p1.html">1</a>, 
      <a href="MComp1996p2.html">2</a>, 
      <a href="MComp1996p3.html">3</a>, 
      <a href="MComp1996p4.html">4</a>, 
      <a href="MComp1996p5.html">5</a>, 
      <a href="MComp1996p6.html">6</a>, 
      <a href="MComp1996p7.html">7</a>, 
      <a href="MComp1996p8.html">8</a>                                                              <p>

<b>    Multiple Precision Complex Arithmetic and Functions </b><br>
    Transactions on Mathematical Software 24 (1998) 359 -- 367                                      <br>
Page  <a href="toms1998p01.html">1</a>, 
      <a href="toms1998p02.html">2</a>, 
      <a href="toms1998p03.html">3</a>, 
      <a href="toms1998p04.html">4</a>, 
      <a href="toms1998p05.html">5</a>, 
      <a href="toms1998p06.html">6</a>, 
      <a href="toms1998p07.html">7</a>, 
      <a href="toms1998p08.html">8</a>, 
      <a href="toms1998p09.html">9</a>, 
      <a href="toms1998p10.html">10</a>                                                             <p>

<b>    Multiple-Precision Gamma Function and Related Functions </b><br>
    Transactions on Mathematical Software 27 (2001) 377 -- 387                                      <br>
Page  <a href="toms2000p01.html">1</a>, 
      <a href="toms2000p02.html">2</a>, 
      <a href="toms2000p03.html">3</a>, 
      <a href="toms2000p04.html">4</a>, 
      <a href="toms2000p05.html">5</a>, 
      <a href="toms2000p06.html">6</a>, 
      <a href="toms2000p07.html">7</a>, 
      <a href="toms2000p08.html">8</a>, 
      <a href="toms2000p09.html">9</a>, 
      <a href="toms2000p10.html">10</a>, 
      <a href="toms2000p11.html">11</a>                                                             <p>

<b>    Multiple-Precision Exponential Integral and Related Functions </b><br>
    Transactions on Mathematical Software 37 (2011) 1 -- 18                                         <br>
Page  <a href="toms2011p01.html">1</a>,
      <a href="toms2011p02.html">2</a>,
      <a href="toms2011p03.html">3</a>,
      <a href="toms2011p04.html">4</a>,
      <a href="toms2011p05.html">5</a>,
      <a href="toms2011p06.html">6</a>,
      <a href="toms2011p07.html">7</a>,
      <a href="toms2011p08.html">8</a>,
      <a href="toms2011p09.html">9</a>,
      <a href="toms2011p10.html">10</a>,
      <a href="toms2011p11.html">11</a>,
      <a href="toms2011p12.html">12</a>,
      <a href="toms2011p13.html">13</a>,
      <a href="toms2011p14.html">14</a>,
      <a href="toms2011p15.html">15</a>,
      <a href="toms2011p16.html">16</a>,
      <a href="toms2011p17.html">17</a>,
      <a href="toms2011p18.html">18</a>,
      <a href="toms2011p19.html">19</a>                                                             <p>

<b>    Using Multiple-Precision Arithmetic </b><br>
    Computing in Science and Engineering 5 (July, 2003) 88 -- 93                                    <br>
Page  <a href="CSE2003p01.html">1</a>, 
      <a href="CSE2003p02.html">2</a>, 
      <a href="CSE2003p03.html">3</a>, 
      <a href="CSE2003p04.html">4</a>, 
      <a href="CSE2003p05.html">5</a>, 
      <a href="CSE2003p06.html">6</a>, 
      <a href="CSE2003p07.html">7</a>, 
      <a href="CSE2003p08.html">8</a>, 
      <a href="CSE2003p09.html">9</a>, 
      <a href="CSE2003p10.html">10</a>, 
      <a href="CSE2003p11.html">11</a>                                                              <p>

<!---------------------------------------------------------------------------->
<HR>


<h2>Automatic conversion of Fortran programs to use FM</h2><p>

<a href="c2fm.html">This page</a> has a program that tries to automate most of the changes          <br>
needed to convert a normal Fortran program to a multiple-precision version using FM.                <p>

<!---------------------------------------------------------------------------->
<HR>


<h2>Function domains</h2><p>

<a href="v3domains.html">This page</a> has a table of domains for FM functions.                        <p>

<!---------------------------------------------------------------------------->
<HR>


<h2>Function timing</h2><p>

<a href="v3timing.html">This page</a> has a table of times for FM functions.                        <p>

<!---------------------------------------------------------------------------->
<HR>


<h2>More sample programs</h2><p>

<a href="samples.html">This page</a> has some example programs solving problems in root-finding,
linear systems of equations,                                                                        <br>
least-squares fitting, integrals, derivatives for real and complex functions, etc.


<!---------------------------------------------------------------------------->
<HR>



<!---------------------------------------------------------------------------->
<HR>

</body>
</html>
